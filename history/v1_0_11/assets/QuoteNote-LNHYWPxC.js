import{o as R,j as e,B as d,T as w,V as se,y as ne,ah as re,K as G,ab as J,g as ie}from"./mui-CyG7s_nf.js";import{r as m}from"./reactVendor-BAhb8EbJ.js";import{u as D}from"./lang-DxTEvHWx.js";import{r as P,bj as le,bk as ce,a2 as de,bl as ue,a5 as S,bm as pe,aR as fe,i as xe,u as I,bn as me,be as he,a as Y,a3 as ge,p as be,R as je,ag as M,bo as K}from"./react-setup-BnN2zy6E.js";import"../index.CmwWzQnO.js";import{q as ye,m as ve}from"./QuoteStatus-CydZMDpY.js";import{n as N}from"./eStyled-B3rIBjaz.js";import{d as we}from"./DeleteOutlined-CrtgL9xS.js";import{n as W}from"./lodashEs-Ck10JMnh.js";var k={},Le=R;Object.defineProperty(k,"__esModule",{value:!0});var X=k.default=void 0,Ce=Le(P()),Fe=e;X=k.default=(0,Ce.default)((0,Fe.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");var Q={},qe=R;Object.defineProperty(Q,"__esModule",{value:!0});var Z=Q.default=void 0,Se=qe(P()),Ie=e;Z=Q.default=(0,Se.default)((0,Ie.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");function ee(o){const{children:u,title:t="",header:r,defaultOpen:i=!1,handleOnChange:s}=o,[p,h]=m.useState(i),g=()=>{h(!p)};return m.useEffect(()=>{s&&s(p)},[s,p]),m.useEffect(()=>{i&&h(i)},[i]),e.jsxs(d,{children:[e.jsxs(d,{onClick:g,sx:{display:"flex",justifyContent:"space-between",cursor:"pointer",alignItems:"center"},children:[r||e.jsx(w,{variant:"h5",children:t}),p?e.jsx(X,{}):e.jsx(Z,{})]}),e.jsx(se,{in:p,timeout:"auto",unmountOnExit:!0,children:u})]})}var O={},De=R;Object.defineProperty(O,"__esModule",{value:!0});var te=O.default=void 0,Ne=De(P()),Be=e;te=O.default=(0,Ne.default)((0,Be.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m1 17h-2v-2h2zm2.07-7.75-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25"}),"Help");const Ae=N(d)(({style:o})=>({"& .file-upload-area":{cursor:"pointer","& .MuiDropzoneArea-textContainer":{display:"flex",alignItems:"center",color:(o==null?void 0:o.color)||"#1976D2"},"& .MuiDropzoneArea-text":{order:1,textTransform:"capitalize",fontWeight:400,fontSize:"14px",lineHeight:"24px"}}})),Te=N(d)(o=>({display:"flex",background:o.hasdelete==="true"?"rgba(25, 118, 210, 0.3)":"rgba(0, 0, 0, 0.12)",borderRadius:"18px",padding:"6px 8px",alignItems:"center",margin:"0 0 2px",color:"rgba(0, 0, 0, 0.54)","& .fileList-name-area":{display:"flex",flex:1,alignItems:"center"},"& .fileList-name":{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",flexGrow:1,flexBasis:"100px",maxWidth:"200px",color:"#313440",fontSize:"14px",cursor:"pointer"}})),ze=N(w)({marginBottom:"16px",fontSize:"10px",color:"rgba(0, 0, 0, 0.38)",padding:"0 12px",textAlign:"right",wordBreak:"break-word"}),V=N(le)(()=>({transform:"rotate(45deg)",marginRight:"5px"}));function _e(o,u){const t=D(),{title:r=t("global.fileUpload.addAttachment"),tips:i=t("global.fileUpload.maxFileSizeMessage"),maxFileSize:s=2097152,fileNumber:p=3,limitUploadFn:h,acceptedFiles:g=ce,onchange:j=W,fileList:l=[],allowUpload:f=!0,onDelete:c=W,isEndLoadding:C=!1,requestType:B="quoteAttachedFile"}=o,T=ne().palette.primary.main,[z,n]=m.useState(!1);m.useImperativeHandle(u,()=>({setUploadLoadding:a=>n(a)}));const x=a=>a/1048576>1?"".concat((a/1048576).toFixed(1),"MB"):a/1024>1?"".concat((a/1024).toFixed(1),"KB"):"".concat(a,"B"),y=(a,v,A)=>{const{size:_,type:E}=a;let U=!1;v.forEach(oe=>{U=new RegExp(oe).test(E)||U});let q="";return U||(q=t("global.fileUpload.fileTypeNotSupported")),_>A&&(q=t("global.fileUpload.fileSizeExceedsLimit",{maxFileSize:x(A)})),q&&S.error(q),q},b=()=>(S.error(t("global.fileUpload.fileSizeExceedsLimit",{maxFileSize:x(s)})),""),L=async a=>{const v=a.length>0?a[0]:null;if(!(v&&h&&h())){if(!h&&v&&l.length>=p){S.error(t("global.fileUpload.maxFileNumber",{fileNumber:p}));return}if(v)try{n(!0);const{code:A,data:_,message:E}=await pe({file:v,type:B});A===200?j({..._,id:fe()}):S.error(E)}finally{C||n(!1)}}},F=a=>{c(a)},ae=a=>{a&&window.open(a,"_blank")};return e.jsx(de,{isSpinning:z,children:e.jsxs(d,{sx:{padding:"12px 0 0",width:"100%"},children:[e.jsx(d,{children:l.map((a,v)=>e.jsxs(d,{children:[e.jsxs(Te,{hasdelete:((a==null?void 0:a.hasDelete)||"").toString(),children:[e.jsxs(d,{className:"fileList-name-area",children:[e.jsx(V,{}),e.jsx(w,{className:"fileList-name",onClick:()=>{ae(a.fileUrl)},children:a.fileName})]}),a.hasDelete&&e.jsx(we,{sx:{cursor:"pointer"},onClick:()=>{F((a==null?void 0:a.id)||"")}})]}),e.jsx(ze,{children:a.title||""})]},a.id||v))}),f&&e.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",marginTop:"10px"},children:[e.jsx(Ae,{style:{color:T},children:e.jsx(ue,{dropzoneClass:"file-upload-area",Icon:V,filesLimit:1,onChange:L,showPreviews:!1,showPreviewsInDropzone:!1,maxFileSize:s,showAlerts:!1,dropzoneText:r,getDropRejectMessage:y,getFileLimitExceedMessage:b,acceptedFiles:g})}),e.jsx(re,{title:i,sx:{fontSize:"20px",color:"rgba(0, 0, 0, 0.54)"},children:e.jsx(te,{})})]})]})})}const Ee=m.forwardRef(_e);function Je(o){const{allowUpload:u=!0,defaultFileList:t=[],status:r,quoteId:i}=o,s=D(),p=xe(),h=I(({company:n})=>n.customer.firstName),g=I(({company:n})=>n.customer.lastName),j=I(({quoteInfo:n})=>n.draftQuoteInfo),[l]=me(),[f,c]=m.useState([]),C=m.useRef(null);m.useEffect(()=>{if(r===0){const{fileInfo:n=[]}=j||{};c(typeof n!="object"?[]:n)}else t.length&&c(t)},[t.length,r]);const B=n=>{if(j){const x={...j,fileInfo:n};p(he(x))}},H=async n=>{var x;try{let y=[];if(r!==0){const b={fileName:n.fileName,fileType:n.fileType,fileUrl:n.fileUrl,fileSize:n.fileSize},{quoteAttachFileCreate:{attachFiles:L}}=await ye({fileList:[{...b}],quoteId:i});b.id=L[0].id,y=[{...b,title:s("global.quoteAttachment.uploadedByCustomer",{createdBy:L[0].createdBy}),hasDelete:!0},...f]}else y=[{...n,title:s("global.quoteAttachment.uploadedByCustomerWithName",{firstName:h,lastName:g}),hasDelete:!0},...f],B(y);c(y)}finally{(x=C.current)==null||x.setUploadLoadding(!1)}},T=async n=>{var x,y;try{(x=C.current)==null||x.setUploadLoadding(!0);const b=f.find(F=>F.id===n),L=f.filter(F=>F.id!==n);r!==0&&b?await ve({fileId:(b==null?void 0:b.id)||"",quoteId:i}):B(L),c(L)}finally{(y=C.current)==null||y.setUploadLoadding(!1)}},z=()=>f.filter(x=>(x==null?void 0:x.title)&&x.title.includes("by customer")).length>=3?(S.error(s("global.quoteAttachment.maxFilesMessage")),!0):!1;return e.jsx(G,{children:e.jsx(J,{sx:{p:"16px !important"},children:e.jsx(ee,{title:s("global.quoteAttachment.title"),children:e.jsx(d,{children:e.jsx(Ee,{ref:C,requestType:l!=="b2b"?"customerQuoteAttachedFile":"quoteAttachedFile",isEndLoadding:!0,fileList:f,limitUploadFn:z,onchange:H,onDelete:T,allowUpload:u})})})})})}const Ue=N("div")(({padding:o="1rem",alignItems:u="flex-start",flexDirection:t="row",backgroundColor:r="white",width:i="100%",xs:s})=>({display:"flex",flexDirection:t,alignItems:u,padding:o,width:i,backgroundColor:r,...s})),Me=["name","email","companyName","phoneNumber","quoteTitle"],$e=["label","firstName","lastName","company","address","apartment","city","state","zipCode","country","phoneNumber"],Re=["label",["firstName","lastName"],"company","address","apartment",["city","state","zipCode","country"],"phoneNumber"];function $({flag:o,title:u,info:t,status:r}){const i=o==="info"?Me:Re,[s]=Y(),p=D(),h=r==="Draft"?"Por favor, añade tu direción de ".concat(o==="Billing"?"facturación":"envío"):"Sin dirección de  ".concat(o==="Billing"?"facturación":"envío"),g=o!=="info"?$e.some(l=>t&&!!t[l]):!1,j=o==="info"||s?0:"10px";return e.jsxs(d,{sx:{width:s?"100%":"33.3%",paddingLeft:j},children:[e.jsx(w,{sx:{fontWeight:400,fontSize:"24px",height:"32px"},children:u}),e.jsxs(d,{sx:{p:"15px 0"},children:[(g||o==="info")&&JSON.stringify(t)!=="{}"&&i.map(l=>l==="quoteTitle"?r==="Draft"?e.jsx(w,{sx:{wordBreak:"break-all"},variant:"body1",children:"".concat(p("quoteDraft.quoteInfo.quoteTitle")).concat(t[l]||"")},l):"":typeof l=="string"?e.jsx(w,{variant:"body1",children:t&&t[l]||""},l):e.jsx(w,{variant:"body1",children:l.map((f,c)=>c===l.length-1?t[f]||"":f==="firstName"?"".concat(t[f]||""," "):t[f]?"".concat(t[f]||"",", "):"")},"".concat(l))),!g&&o!=="info"&&e.jsx(d,{children:h})]})]})}function Ye({contactInfo:o,shippingAddress:u,billingAddress:t,handleEditInfoClick:r,status:i}){const s=D(),[p]=Y();return e.jsxs(Ue,{flexDirection:"column",xs:{boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)",borderRadius:"4px"},children:[e.jsxs(d,{sx:{width:"100%",display:"flex",justifyContent:"space-between",flexDirection:p?"column":"row"},children:[e.jsx($,{title:s("quoteDraft.contactInfo.contact"),flag:"info",status:i,info:o}),e.jsx($,{title:s("global.quoteInfo.billing"),flag:"Billing",status:i,info:t}),e.jsx($,{title:s("global.quoteInfo.shipping"),flag:"Shipping",status:i,info:u})]}),r&&e.jsx(ge,{sx:{mt:"10px",mb:"15px"},onClick:r,variant:"outlined",children:s("global.quoteInfo.editInfo")})]})}function Xe(o){const u=D(),{quoteStatus:t,quoteNotes:r=""}=o,[i,s]=m.useState(""),[p,h]=m.useState(!1),g=I(be),j=I(je),l=g?j.quotesActionsPermission:!0,f=c=>{s((c==null?void 0:c.target.value)||""),M.dispatch(K((c==null?void 0:c.target.value)||""))};return m.useEffect(()=>{const c=M.getState().quoteInfo.draftQuoteInfo.note||"";s(c)},[]),m.useEffect(()=>{M.dispatch(K(i||""))},[i]),m.useEffect(()=>{r&&h(!0)},[r]),e.jsx(G,{children:e.jsx(J,{sx:{p:"16px !important"},children:e.jsx(ee,{title:u(t&&t==="Draft"?"global.quoteNote.message":"global.quoteNote.notes"),defaultOpen:p,children:e.jsxs(d,{sx:{padding:"16px 0"},children:[t&&t==="Draft"&&e.jsx(d,{sx:{fontSize:"16px",color:"rgba(0, 0, 0, 0.38)",mb:"16px"},children:u("global.quoteNote.messageNote")}),r?e.jsx(w,{variant:"body1",style:{whiteSpace:"pre-line",maxHeight:"400px",overflow:"auto"},children:r}):e.jsx(d,{children:l?e.jsx(ie,{multiline:!0,fullWidth:!0,rows:5,value:i,onChange:f,label:u("global.quoteNote.typeMessage"),size:"small",variant:"outlined",sx:{"& .MuiFormLabel-root":{color:"rgba(0, 0, 0, 0.38)"}}}):null})]})})})})}export{ee as B,Ue as C,Ye as Q,Xe as a,Je as b};
