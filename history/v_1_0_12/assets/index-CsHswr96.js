import{j as t,K as ke,ab as ne,B as p,T as F,ae as Kt,G as ht,a0 as Xt,W as Pe,X as Ie,s as Nt,g as Ht,y as Te}from"./mui-CyG7s_nf.js";import{r as a}from"./reactVendor-BAhb8EbJ.js";import{u as kt}from"./lang-DxTEvHWx.js";import{c as ve,i as Ae}from"./lodashEs-Ck10JMnh.js";import{a as wt,bQ as we,u as et,aV as Gt,a5 as O,a3 as vt,aX as Be,aE as Oe,aF as De,bI as qe,R as Ft,aN as oe,_ as Wt,a2 as ae,b9 as Jt,aD as Ut,am as At,ba as Yt,bR as re,aI as ce,e as le,U as de,G as pe,a1 as Ee,aG as Ne,aH as Fe,au as Qe,at as Re,av as Ve,bS as $e,aO as ue,aP as he,aQ as ge,aR as Ue,aS as ze,aT as xe,aU as Me,C as _e,k as Ge,b5 as Vt,ab as He,aY as We,bT as Zt,bU as te,p as Je,aA as Ke,bV as Xe,bW as Ye,bK as Ze,bL as ts,a6 as es,bX as ss,bY as is,bZ as ns}from"./react-setup-BE8w6ZrM.js";import"../index.CrdzTz2H.js";import{u as os,C as as}from"./useCustomCallbacks-D2SU_LXI.js";import{a as me,S as rs,d as cs,C as ls,b as ds}from"./SearchProduct-CM3Q4NPR.js";import{u as ps}from"./useBlockPendingAccountViewPrice-DgCmZEST.js";import{Q as us}from"./QuickAdd-DEfHbm03.js";import{n as zt}from"./eStyled-B3rIBjaz.js";import{s as Et}from"./B3LinkTipContent-BURvls1t.js";import{b as $t}from"./b3TriggerCartNumber-noC78pOx.js";import{c as Mt,b as hs,A as gs,d as fe,E as ye}from"./muiIcon-BfPleEzf.js";import{b as xs}from"./b3Logger-CMQiGC3f.js";import{S as ms}from"./ShoppingStatus-CJ9FyC7T.js";import{u as Se,c as fs}from"./router-BbCjXwHs.js";import{b as Le}from"./b2bGetVariantImageByVariantInfo-BMNBG_0_.js";import{u as ys}from"./useSort-Cu2YrCwH.js";import{B as Ss}from"./B3FilterSearch-CP6nQh0Y.js";import"./eReact-DeS39u1B.js";import"./intl-CIPMD0ue.js";import"./eCache-BQInSoPa.js";import"./redux-B-shcavw.js";import"./toolkit-CHPG993j.js";import"./dateFns-BB2kaHor.js";import"./dropzone-D4lSiSJA.js";import"./form-Bvi8lP6x.js";import"./B3CustomForm-BKoFYO-g.js";function Ls(k){const[s]=wt(),{disabled:i=!1,label:n=s?"Qty":"",value:o="",maxQuantity:y=0,minQuantity:u=0,isStock:A="0",stock:E=0,hiddenLabel:m=!s,onChange:Q=()=>{},sx:K={width:s?"110px":"72px","& .MuiFormHelperText-root":{marginLeft:"0",marginRight:"0"}}}=k,[D,G]=a.useState(""),j=a.useCallback(f=>{const h=parseInt("".concat(f),10)||0;let x="";return A==="1"&&E===0?x="Agotado":A==="1"&&h>E?x="".concat(E," en stock"):u!==0&&h<u?x="Mínimo es ".concat(u):y!==0&&h>y&&(x="Máximo es ".concat(y)),G(x),x},[A,y,u,E]),P=f=>{Q(f,!!D)},S=()=>{const f=parseInt("".concat(o),10)||0;Q(f,!j(f))};return a.useEffect(()=>{j(o)},[j,o]),t.jsx(we,{size:"small",type:"number",variant:"outlined",disabled:i,hiddenLabel:m,label:n,value:o,error:!!D,helperText:D,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},onChange:f=>{P(f.target.value)},onBlur:()=>{S()},sx:K})}function Cs(k){const{state:{id:s}}=a.useContext(me),i=et(({company:h})=>h.companyInfo.status),{updateList:n,isB2BUser:o,type:y=""}=k,u=kt(),[A,E]=a.useState(!1),[m,Q]=a.useState(!1),[K]=ps(),D=o?Oe:De,G=os(as.OnAddToShoppingList,async(h,x)=>{try{if(!x(h))throw new Error;const r=h.map(g=>({optionList:Gt(g.newSelectOptionList,g),productId:g.id,quantity:g.quantity,variantId:g.variantId})),I=await D({shoppingListId:s,items:r});return O.success(u("shoppingList.addToShoppingList.productsAdded"),{isClose:!0}),I}catch(r){r.message.length>0&&O.error(r.message,{isClose:!0})}return!0}),j=async h=>{const x=h.map(I=>({optionList:Gt(I.newSelectOptionList||I.optionList,(I==null?void 0:I.products)||I)||[],productId:parseInt(I.productId,10)||0,quantity:I.quantity,variantId:parseInt(I.variantId,10)||0})),r=await D({shoppingListId:s,items:x});return O.success(u("shoppingList.addToShoppingList.productsAdded"),{isClose:!0}),r},P=h=>{const x=[],r=[],I=[];return h.forEach(g=>{const{products:d,qty:H}=g,{option:l,purchasingDisabled:V,variantSku:T,variantId:X,productId:Y,modifiers:ct}=d,$=qe(ct);if(V&&y!=="shoppingList"){x.push(T);return}if($.filter(w=>!w.isVerified).length>0){I.push(T);return}const W=l.map(w=>({optionId:"attribute[".concat(w.option_id,"]"),optionValue:w.id.toString()}));$.forEach(w=>{const{type:lt}=w;if(lt==="date"){const{defaultValue:_}=w;Object.keys(_).forEach(J=>{W.push({optionId:"attribute[".concat(w.option_id,"][").concat(J,"]"),optionValue:"".concat(w.defaultValue[J])})})}else W.push({optionId:"attribute[".concat(w.option_id,"]"),optionValue:"".concat(w.defaultValue)})}),r.push({productId:parseInt(Y,10)||0,variantId:parseInt(X,10)||0,quantity:+H,optionList:W,products:g.products})}),{notPurchaseSku:x,productItems:r,notAddAble:I}},S=async h=>{Q(!0);try{const{validProduct:x}=h,{notPurchaseSku:r,productItems:I,notAddAble:g}=P(x);I.length>0&&(await j(I),n()),g.length>0&&y!=="shoppingList"&&O.error(u("shoppingList.addToShoppingList.skuNotAddable",{notAddAble:g.join(", ")}),{isClose:!0}),r.length>0&&y!=="shoppingList"&&O.error(u("shoppingList.addToShoppingList.skuNotPurchasable",{notPurchaseSku:r.join(", ")}),{isClose:!0}),E(!1)}finally{Q(!1)}},f=()=>{K&&i===0?O.info("Your business account is pending approval. This feature is currently disabled."):E(!0)};return t.jsx(ke,{sx:{marginBottom:"50px"},children:t.jsx(ne,{children:t.jsxs(p,{children:[t.jsx(F,{variant:"h5",children:u("shoppingList.addToShoppingList.addToList")}),t.jsx(rs,{updateList:n,addToList:G,isB2BUser:o,type:"shoppingList"}),t.jsx(Kt,{}),t.jsx(us,{type:"shoppingList",updateList:n,quickAddToList:j}),t.jsx(Kt,{}),t.jsx(p,{sx:{margin:"20px 0 0"},children:t.jsxs(vt,{variant:"text",onClick:()=>f(),children:[t.jsx(cs,{sx:{marginRight:"8px"}}),u("shoppingList.addToShoppingList.bulkUploadCsv")]})}),t.jsx(Be,{isOpen:A,setIsOpen:E,handleAddToList:S,isLoading:m,withModifiers:!0})]})})})}const ee=zt("div")(({isHeader:k,isMobile:s})=>({display:"flex",wordBreak:"break-word",padding:"8px 0 0",gap:"8px",flexWrap:s?"wrap":"initial",...k?{borderBottom:"1px solid #D9DCE9",paddingBottom:"8px",alignItems:"center"}:{alignItems:"flex-start"},...s?{borderTop:"1px solid #D9DCE9",padding:"12px 0 12px","&:first-of-type":{marginTop:"12px"}}:{}})),bt=zt(p)(({width:k,padding:s="0",flexBasis:i,flexDirection:n="row",alignItems:o,textAlignLocation:y})=>({display:"flex",justifyContent:y==="right"?"flex-end":"flex-start",flexDirection:n,flexGrow:k?0:1,flexShrink:k?0:1,alignItems:o||"flex-start",flexBasis:i,width:k,padding:s})),qt=zt("div")(()=>({fontSize:"0.875rem",lineHeight:"1.5",color:"#263238"})),bs=zt("img")(()=>({width:"60px",borderRadius:"4px",flexShrink:0})),js={default:{width:"15%"},qty:{width:"80px"},delete:{width:"30px"}},ks={default:{width:"100%",padding:"0 0 0 76px"},qty:{width:"100%",padding:"0 0 0 76px"},delete:{width:"100%",padding:"0 0 0 76px",display:"flex",flexDirection:"row-reverse"}};function Ps(k){const{shoppingListInfo:s,products:i,successProducts:n,allowJuniorPlaceOrder:o,setValidateFailureProducts:y,setValidateSuccessProducts:u,textAlign:A="left"}=k,{submitShoppingListPermission:E}=et(Ft),m=kt(),[Q,K]=a.useState(!1),[D,G]=a.useState(!1),[j]=wt(),{decimal_places:P=2}=et(oe);a.useEffect(()=>{i.length>0?K(!0):K(!1)},[i]);const S=j?ks:js,f=async(g,d,H)=>{const l=[...i];l[g].node.quantity=+d,l[g].isValid=H;const V=await Yt(l[g].node,+d);V&&(l[g].node=V,y(l))},h=()=>{K(!1),y([]),u([])},x=g=>{const d=[...i];d.splice(g,1),y(d)},r=async()=>{if(!i.every(d=>d.isValid)){O.error(m("shoppingList.reAddToCart.fillCorrectQuantity"));return}try{G(!0);const d=re(i),H=await ce(d);H.errors||(h(),o&&E&&(s==null?void 0:s.status)===0?window.location.href=le:(O.success("",{jsx:Et({message:m("shoppingList.reAddToCart.productsAdded"),link:de,linkText:m("shoppingList.reAddToCart.viewCart"),isOutLink:!0,isCustomEvent:!0}),isClose:!0}),$t())),H.errors&&O.error(H.message,{isClose:!0}),$t()}finally{G(!1)}},I=async()=>{const g=i.filter(l=>l.isStock==="0"||l.stock!==0),d=[];g.forEach(l=>{var w;const V=l,{node:{quantity:T},minQuantity:X=0,maxQuantity:Y=0,isStock:ct,stock:$}=l,Z=parseInt("".concat(T),10)||0;X!==0&&Z<X?V.node.quantity=X:Y!==0&&Z>Y&&(V.node.quantity=Y),ct!=="0"&&$&&(T?+T:0)>$&&(V.node.quantity=$),V.isValid=!0;const W=(w=l==null?void 0:l.node)!=null&&w.quantity?+l.node.quantity:0;d.push(Yt(l.node,W))}),(await Promise.all(d)).forEach((l,V)=>{g[V].node=l}),y(g)};return t.jsx(Wt,{isOpen:Q,handleLeftClick:h,handRightClick:r,title:m(o?"shoppingList.reAddToCart.proceedToCheckout":"shoppingList.reAddToCart.addToCart"),rightSizeBtn:m(o?"shoppingList.reAddToCart.proceedToCheckout":"shoppingList.reAddToCart.addToCart"),maxWidth:"xl",children:t.jsxs(ht,{children:[t.jsx(p,{sx:{m:"0 0 1rem 0"},children:t.jsx(Xt,{variant:"outlined",severity:"success",children:o?m("shoppingList.reAddToCart.productsCanCheckout",{successProducts:n}):m("shoppingList.reAddToCart.productsAddedToCart",{successProducts:n})})}),t.jsx(p,{sx:{m:"1rem 0"},children:t.jsx(Xt,{variant:"outlined",severity:"error",children:o?m("shoppingList.reAddToCart.productsCantCheckout",{quantity:i.length}):m("shoppingList.reAddToCart.productsNotAddedToCart",{quantity:i.length})})}),t.jsxs(ae,{isSpinning:D,size:16,isFlex:!1,children:[t.jsxs(p,{sx:{display:"flex",justifyContent:"space-between",margin:"0.5rem 0 1rem 0"},children:[t.jsx(p,{sx:{fontSize:"24px"},children:m("shoppingList.reAddToCart.productCount",{quantity:i.length})}),t.jsx(vt,{onClick:()=>I(),children:m("shoppingList.reAddToCart.adjustQuantity")})]}),i.length>0?t.jsxs(p,{children:[!j&&t.jsxs(ee,{isHeader:!0,isMobile:j,children:[t.jsx(bt,{children:t.jsx(qt,{children:m("shoppingList.reAddToCart.product")})}),t.jsx(bt,{...S.default,textAlignLocation:A,children:t.jsx(qt,{children:m("shoppingList.reAddToCart.price")})}),t.jsx(bt,{sx:{justifyContent:"center"},...S.default,textAlignLocation:A,children:t.jsx(qt,{children:m("shoppingList.reAddToCart.quantity")})}),t.jsx(bt,{...S.default,textAlignLocation:A,children:t.jsx(qt,{children:m("shoppingList.reAddToCart.total")})}),t.jsx(bt,{...S.delete,children:t.jsx(qt,{children:" "})})]}),i.map((g,d)=>{const{isStock:H,maxQuantity:l,minQuantity:V,stock:T}=g,{quantity:X=1,primaryImage:Y,productName:ct,variantSku:$,optionList:Z,productsSearch:W,basePrice:w}=g.node,lt=+w,_=(lt*(X?+X:0)).toFixed(P),J={...W,selectOptions:Z},nt=Jt(J,{}),L=JSON.parse(Z),st=nt.filter(R=>R.valueText);return t.jsxs(ee,{isMobile:j,children:[t.jsxs(bt,{children:[t.jsx(bs,{src:Y||Ut}),t.jsxs(p,{sx:{marginLeft:"16px"},children:[t.jsx(F,{variant:"body1",color:"#212121",children:ct}),t.jsx(F,{variant:"body1",color:"#616161",children:$}),L.length>0&&st.length>0&&st.map(R=>t.jsx(F,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat(R.valueLabel,": ").concat(R.valueText)},R.valueLabel))]})]}),t.jsxs(bt,{...S.default,textAlignLocation:A,children:[j&&t.jsx("span",{children:"Price: "}),"".concat(At(lt))]}),t.jsx(bt,{...S.default,textAlignLocation:A,children:t.jsx(Ls,{isStock:H,maxQuantity:l,minQuantity:V,stock:T,value:X,onChange:(R,at)=>{f(d,R,at)}})}),t.jsxs(bt,{...S.default,textAlignLocation:A,children:[j&&t.jsx("div",{children:"Total: "}),"".concat(At(_))]}),t.jsx(bt,{...S.delete,children:t.jsx(Mt,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{x(d)}})})]},$)})]}):null]})]})})}function Is(k){const s=kt(),[i]=wt(),{open:n,handleCancelClick:o,handleDeleteProductClick:y}=k;return t.jsx(Wt,{isOpen:n,title:s("shoppingList.deleteItems.subtotal"),leftSizeBtn:s("shoppingList.deleteItems.cancel"),rightSizeBtn:s("shoppingList.deleteItems.delete"),handleLeftClick:o,handRightClick:y,rightStyleBtn:{color:"#D32F2F"},children:t.jsx(p,{sx:{display:"flex",justifyContent:"".concat(i?"center%":"start"),width:"".concat(i?"100%":"450px"),height:"100%"},children:s("shoppingList.deleteItems.confirmDelete")})})}function Ts(k){const[s]=wt(),i=kt(),{state:{productQuoteEnabled:n=!1}}=a.useContext(pe),o=et(({b2bFeatures:L})=>L.masqueradeCompany.isAgenting),y=et(({company:L})=>L.companyInfo.id),u=et(({company:L})=>L.customer.customerGroupId),{shoppingListActionsPermission:A,purchasabilityPermission:E,submitShoppingListPermission:m}=et(Ft),Q=a.useRef(null),[K,D]=a.useState(!1),G=Ee.get("cartId"),j=s?{alignItems:"flex-start",flexDirection:"column"}:{alignItems:"center"},{shoppingListInfo:P,allowJuniorPlaceOrder:S,checkedArr:f,selectedSubTotal:h,setLoading:x,setDeleteOpen:r,setValidateFailureProducts:I,setValidateSuccessProducts:g,isB2BUser:d,customColor:H,isCanEditShoppingList:l,role:V}=k,T=d?A:!0,X=d?E:!0,Y=d?m:+V==2,ct=()=>{f.length===0?O.error(i("shoppingList.footer.selectOneItem")):D(!0)},$=()=>{D(!1)},Z=L=>{const st=[],R=[];return f.forEach(at=>{const{node:B}=at,U=L.find(z=>z.variantSku===B.variantSku)||{};if(U){let z=!0;U.isStock==="1"&&(B!=null&&B.quantity?+B.quantity:0)>U.stock&&(z=!1),U.minQuantity!==0&&(B!=null&&B.quantity?+B.quantity:0)<U.minQuantity&&(z=!1),U.maxQuantity!==0&&(B!=null&&B.quantity?+B.quantity:0)>U.maxQuantity&&(z=!1),z?R.push({node:B}):st.push({node:{...B},stock:U.stock,isStock:U.isStock,maxQuantity:U.maxQuantity,minQuantity:U.minQuantity})}}),{validateFailureArr:st,validateSuccessArr:R}},W=async()=>{if(f.length===0){O.error(i("shoppingList.footer.selectOneItem"));return}$(),x(!0);try{const L=[];let st="";if(f.forEach(z=>{const{node:ot}=z;ot.productsSearch.availability==="disabled"&&(st+="".concat(ot.variantSku,",")),L.push(ot.variantSku)}),st){O.error(i("shoppingList.footer.unavailableProducts",{skus:st.slice(0,-1)}),{isClose:!0});return}if(L.length===0){O.error(i(S?"shoppingList.footer.selectItemsToCheckout":"shoppingList.footer.selectItemsToAddToCart"),{isClose:!0});return}const at=await(d?Ne:Fe)({skus:L}),{validateFailureArr:B,validateSuccessArr:U}=Z((at==null?void 0:at.variantSku)||[]);if(U.length!==0){const z=re(U),ot=Qe(G),mt=await Re();let dt=null;S&&mt.length?(await Ve(ot),dt=await $e(mt,z)):(dt=await ce(z),$t()),dt&&dt.errors?O.error(dt.errors[0].message,{isClose:!0}):B.length===0&&(S&&Y&&(P==null?void 0:P.status)===0?window.location.href=le:(O.success("",{jsx:Et({message:i("shoppingList.footer.productsAddedToCart"),link:de,linkText:i("shoppingList.footer.viewCart"),isOutLink:!0,isCustomEvent:!0}),isClose:!0}),$t()))}I(B),g(U)}finally{x(!1)}},w=L=>(L==null?void 0:L.length)===0?[]:L.map(({option_id:R,option_value:at})=>({optionId:R,optionValue:at})),lt=async()=>{if(f.length===0){O.error(i("shoppingList.footer.selectOneItem"));return}x(!0),$();try{const L=f.filter(yt=>{const{node:{variantSku:pt}}=yt;return pt!==""&&pt!==null&&pt!==void 0}),st=f.filter(yt=>{const{node:{variantSku:pt}}=yt;return!pt});if(st.length>0&&O.error(i("shoppingList.footer.cantAddProductsNoSku"),{isClose:!0}),st.length===f.length)return;const R=[];L.forEach(yt=>{const{node:pt}=yt;R.includes(+pt.productId)||R.push(+pt.productId)});const at=d?ue:he,{productsSearch:B}=await at({productIds:R,companyId:y,customerGroupId:u}),U=ge(B);let z=!1,ot="",mt=!0;const dt=[];if(L.forEach(yt=>{const{node:{basePrice:pt,optionList:Bt,variantSku:Pt,productId:It,productName:Tt,quantity:Ot,variantId:Dt,tax:c}}=yt,N=w(JSON.parse(Bt)),M=U.find(ft=>+ft.id==+It),q=M==null?void 0:M.variants.find(ft=>ft.sku===Pt);q||(ot=i("shoppingList.footer.notFoundSku",{sku:Pt}),mt=!1);const rt={node:{id:Ue(),variantSku:(q==null?void 0:q.sku)||Pt,variantId:Dt,productsSearch:M,primaryImage:(q==null?void 0:q.image_url)||Ut,productName:Tt,quantity:+Ot||1,optionList:JSON.stringify(N),productId:It,basePrice:pt,tax:c}};dt.push(rt),z=!0}),z=ze(dt),!mt){O.error("",{jsx:Et({message:ot,link:"",linkText:"",isOutLink:!1}),isClose:!0});return}z?(await xe(dt,"2"),Me(dt),O.success("",{jsx:Et({message:i("shoppingList.footer.productsAddedToQuote"),link:"/quoteDraft",linkText:i("shoppingList.footer.viewQuote"),isOutLink:!1}),isClose:!0})):O.error("",{jsx:Et({message:i("shoppingList.footer.productsLimit"),link:"/quoteDraft",linkText:i("shoppingList.footer.viewQuote"),isOutLink:!1}),isClose:!0})}catch(L){xs.error(L)}finally{x(!1)}},_={adSelectedToCart:{name:i("shoppingList.footer.addToCart"),key:"add-selected-to-cart",handleClick:W,isDisabled:!1},proceedToCheckout:{name:i("shoppingList.footer.proceedToCheckout"),key:"add-select-to-checkout",handleClick:W,isDisabled:!1},addSelectedToQuote:{name:i("shoppingList.footer.addToQuote"),key:"add-selected-to-quote",handleClick:lt,isDisabled:!1}},nt=(P==null?void 0:P.status)===0||!d?!X&&d?n?[_.addSelectedToQuote]:[]:Y?S&&n?[_.proceedToCheckout,_.addSelectedToQuote]:S?[_.proceedToCheckout]:n?[_.addSelectedToQuote]:[]:n?[_.adSelectedToCart,_.addSelectedToQuote]:[_.adSelectedToCart]:[];return t.jsxs(ht,{sx:{position:"fixed",bottom:s&&o?"52px":0,left:0,backgroundColor:"#fff",width:"100%",padding:s?"0 0 1rem 0":"0 40px 1rem 40px",height:s?"8rem":"auto",marginLeft:0,display:"flex",flexWrap:"nowrap",zIndex:"999"},container:!0,spacing:2,children:[t.jsx(ht,{item:!0,sx:{display:s?"none":"block",width:"290px",paddingLeft:"20px"}}),t.jsx(ht,{item:!0,sx:s?{flexBasis:"100%"}:{flexBasis:"690px",flexGrow:1},children:t.jsxs(p,{sx:{width:"100%",pr:"20px",display:"flex",zIndex:"999",justifyContent:"space-between",...j},children:[t.jsx(F,{sx:{color:"#000000",fontSize:"16px",fontWeight:"400"},children:i("shoppingList.footer.selectedProducts",{quantity:f.length})}),t.jsxs(p,{sx:{display:"flex",alignItems:"center",flexWrap:s?"wrap":"nowrap"},children:[t.jsx(F,{variant:"h6",sx:{fontSize:"16px",fontWeight:"700",color:"#000000"},children:i("shoppingList.footer.subtotal",{subtotal:At(h)})}),t.jsxs(p,{sx:{display:"flex",alignItems:"center",marginTop:s?"0.5rem":0,width:s?"100%":"auto"},children:[!S&&l&&T&&t.jsx(vt,{sx:{padding:"5px",border:"1px solid ".concat(H||"#1976d2"),margin:s?"0 1rem 0 0":"0 1rem",minWidth:"auto"},disabled:(P==null?void 0:P.status)===40,children:t.jsx(Mt,{color:"primary",sx:{color:H},onClick:()=>{r(!0)}})}),nt.length?t.jsxs(p,{sx:{display:"flex",alignItems:"center",marginTop:s?"0.5rem":0,marginLeft:s?0:"20px",width:s?"100%":"auto"},children:[nt.length===1&&nt[0]&&t.jsx(vt,{variant:"contained",onClick:nt[0].handleClick,sx:{marginRight:s?"1rem":0,width:s?"100%":"auto"},children:nt[0].name}),nt.length===2&&t.jsxs(t.Fragment,{children:[t.jsx(vt,{variant:"contained",onClick:ct,ref:Q,sx:{marginRight:s?"1rem":0,width:s?"100%":"auto"},endIcon:t.jsx(hs,{}),children:i("shoppingList.footer.addSelectedTo")}),t.jsx(Pe,{id:"basic-menu",anchorEl:Q.current,open:K,onClose:$,MenuListProps:{"aria-labelledby":"basic-button"},children:nt.length>1&&nt.map(L=>t.jsx(Ie,{onClick:()=>{L.handleClick()},children:L.name},L.key))})]})]}):null]})]})]})}),t.jsx(ht,{item:!0,sx:s?{flexBasis:"100%",display:s?"none":"block"}:{flexBasis:"340px",display:s?"none":"block"}})]})}const vs=Nt("div")(()=>({display:"flex",alignItems:"center"}));function As(k){var f;const s=kt(),[i]=wt(),{shoppingListInfo:n,customerInfo:o,handleUpdateShoppingList:y,goToShoppingLists:u,isB2BUser:A,setOpenPage:E,openAPPParams:m,customColor:Q}=k,{state:{portalStyle:{backgroundColor:K="#FEF9F5"}}}=a.useContext(_e),D=Se(),G=((f=n==null?void 0:n.products)==null?void 0:f.edges.length)===0,{submitShoppingListPermission:j,approveShoppingListPermission:P}=et(Ft),S=h=>i?{}:{xs:h};return t.jsxs(t.Fragment,{children:[t.jsx(p,{sx:{marginBottom:"16px",width:"fit-content"},children:t.jsxs(p,{sx:{color:"#1976d2",cursor:"pointer",display:"flex",alignItems:"center"},onClick:()=>{m.shoppingListBtn!=="add"?u():(D("/"),E({isOpen:!1,openUrl:""}))},children:[t.jsx(gs,{fontSize:"small",sx:{fontSize:"12px",marginRight:"0.5rem",color:Q}}),t.jsx(p,{sx:{margin:0,color:Q,m:"0"},children:m.shoppingListBtn!=="add"?s("shoppingList.header.backToShoppingLists"):s("shoppingList.header.backToProduct")})]})}),t.jsxs(ht,{container:!0,spacing:2,sx:{display:"flex",justifyContent:"space-between",flexDirection:"".concat(i?"column":"row"),mb:"".concat(i?"16px":"")},children:[t.jsxs(ht,{item:!0,...S(8),sx:{color:Ge(K)},children:[t.jsxs(p,{sx:{display:"flex",alignItems:"".concat(i?"start":"center"),flexDirection:"".concat(i?"column":"row")},children:[t.jsx(F,{variant:"h4",sx:{marginRight:"1rem",wordBreak:"break-all"},children:"".concat((n==null?void 0:n.name)||"")}),A&&(j||P&&(n==null?void 0:n.approvedFlag))&&t.jsx(F,{sx:{m:"".concat(i?"10px 0":"0")},children:n&&t.jsx(ms,{status:n==null?void 0:n.status})})]}),t.jsxs(p,{children:[t.jsx(F,{sx:{width:"100%",wordBreak:"break-all"},children:n==null?void 0:n.description}),A&&t.jsxs(vs,{children:[t.jsx(F,{variant:"subtitle2",sx:{marginRight:"0.5rem"},children:s("shoppingList.header.createdBy")}),t.jsx("span",{children:"".concat((o==null?void 0:o.firstName)||""," ").concat((o==null?void 0:o.lastName)||"")})]})]})]}),t.jsxs(ht,{item:!0,sx:{textAlign:"".concat(i?"none":"end")},...S(4),children:[j&&(n==null?void 0:n.status)===30&&t.jsx(vt,{variant:"outlined",disabled:G,onClick:()=>{y(40)},children:s("shoppingList.header.submitForApproval")}),P&&(n==null?void 0:n.status)===40&&t.jsxs(p,{children:[t.jsx(vt,{variant:"outlined",sx:{marginRight:"1rem"},onClick:()=>{y(20)},children:s("shoppingList.header.reject")}),P&&t.jsx(vt,{variant:"outlined",onClick:()=>{y(0)},children:s("shoppingList.header.approve")})]})]})]})]})}function ws(k){const s=kt(),[i]=wt(),{open:n,notes:o,setNotes:y,handleCancelAddNotesClick:u,handleAddItemNotesClick:A}=k;return t.jsx(Wt,{isOpen:n,title:s("shoppingList.addItemNotes.title"),leftSizeBtn:s("shoppingList.addItemNotes.cancel"),rightSizeBtn:s("shoppingList.addItemNotes.save"),handleLeftClick:u,handRightClick:A,isShowBordered:!1,children:t.jsx(p,{sx:{display:"flex",justifyContent:"".concat(i?"center%":"start"),width:"".concat(i?"100%":"450px"),height:"100%"},children:t.jsx(Ht,{multiline:!0,rows:6,defaultValue:o,onChange:E=>y(E.target.value),variant:"outlined",fullWidth:!0,placeholder:s("shoppingList.addItemNotes.placeholder")})})})}const Bs=Nt("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"}));function Os(k){const s=kt(),{item:i,onEdit:n,onDelete:o,checkBox:y,handleUpdateProductQty:u,handleUpdateShoppingListItem:A,isReadForApprove:E,len:m,itemIndex:Q,setDeleteOpen:K,setAddNoteOpen:D,setAddNoteItemId:G,setNotes:j,showPrice:P,b2bAndBcShoppingListActionsPermissions:S}=k,{basePrice:f,quantity:h,itemId:x,variantId:r,primaryImage:I,productName:g,variantSku:d,productsSearch:H,productUrl:l,taxPrice:V=0,productNote:T}=i,X=Vt(+f,+V),Y=X*+h,ct={...i.productsSearch,selectOptions:i.optionList},$=Jt(ct,{}),Z=JSON.parse(i.optionList),W=$.filter(J=>J.valueText),w=Z.length>0&&!E&&S,lt=ct.variants||[],_=Le(lt,{variantId:r,variantSku:d})||I;return t.jsx(p,{sx:{borderTop:"1px solid #D9DCE9",borderBottom:Q===m-1?"1px solid #D9DCE9":""},children:t.jsxs(ne,{sx:{color:"#313440",display:"flex",pl:0},children:[t.jsx(p,{children:y&&y()}),t.jsx(p,{children:t.jsx(Bs,{src:_||Ut,alt:"Product-img",loading:"lazy"})}),t.jsxs(p,{sx:{flex:1},children:[t.jsx(F,{variant:"body1",color:"#212121",onClick:()=>{const{location:{origin:J}}=window;window.location.href="".concat(J).concat(l)},sx:{cursor:"pointer"},children:g}),t.jsx(F,{variant:"body1",color:"#616161",children:d}),t.jsx(p,{sx:{margin:"0 0 0.5rem 0"},children:Z.length>0&&W.length>0&&t.jsx(p,{children:W.map(J=>t.jsx(F,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat(J.valueLabel,": ").concat(J.valueText)},J.valueLabel))})}),T&&T.trim().length>0&&t.jsx(F,{sx:{fontSize:"0.75rem",color:"#ED6C02",marginTop:"0.3rem",marginBottom:"0.3rem"},children:T}),t.jsx(F,{sx:{color:"#212121",fontSize:"14px"},children:s("shoppingList.shoppingDetailCard.price",{price:P(At(X),i)})}),t.jsx(Ht,{size:"small",type:"number",variant:"outlined",label:s("shoppingList.shoppingDetailCard.quantity"),disabled:S?E:!0,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},value:h,sx:{margin:"0.5rem 0",width:"60%",maxWidth:"100px","& label":{zIndex:0,fontSize:"14px"},"& input":{fontSize:"14px"}},onChange:J=>{u(i.id,J.target.value)},onBlur:()=>{A(x)}}),t.jsx(F,{sx:{color:"#212121",fontSize:"14px"},children:s("shoppingList.shoppingDetailCard.total",{total:P(At(Y),i)})}),t.jsxs(p,{sx:{marginTop:"11px",textAlign:"end"},id:"shoppingList-actionList-mobile",children:[S&&t.jsx(fe,{sx:{marginRight:"0.5rem",cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{D(!0),G(+x),T&&j(T)}}),w&&t.jsx(ye,{sx:{marginRight:w?"0.5rem":"",marginLeft:w?"0.3rem":"",cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{n({...H,selectOptions:Z,quantity:h},r,x)}}),S&&!E&&t.jsx(Mt,{sx:{marginLeft:"0.3rem",cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{K(!0),o(+x)}})]})]})]})},i.id)}const Ds=Nt("div")(()=>({backgroundColor:"#FFFFFF",padding:"1rem",borderRadius:"4px",boxShadow:"0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px rgba(0, 0, 0, 0.14), 0px 1px 3px rgba(0, 0, 0, 0.12)","& tbody":{"& tr":{"& td":{verticalAlign:"top"},"& td: first-of-type":{paddingTop:"15px"}},"& tr: hover":{"& #shoppingList-actionList":{opacity:1}}}})),qs=Nt("img")(()=>({maxWidth:"60px",height:"auto",marginRight:"0.5rem"})),Es=Nt(Ht)(()=>({"& input":{paddingTop:"12px",paddingRight:"6px"}})),se="updatedAt",ie={Product:"productName",updatedAt:"updatedAt",Qty:"quantity"};function Ns(k,s){var Qt;const[i]=wt(),n=kt(),{shoppingListInfo:o,isRequestLoading:y,setIsRequestLoading:u,shoppingListId:A,getShoppingListDetails:E,setCheckedArr:m,isReadForApprove:Q,setDeleteItemId:K,setDeleteOpen:D,isJuniorApprove:G,isB2BUser:j,allowJuniorPlaceOrder:P,productQuoteEnabled:S,isCanEditShoppingList:f,role:h}=k,x=et(({global:e})=>e.showInclusiveTaxPrice),{shoppingListActionsPermission:r,submitShoppingListPermission:I}=et(Ft),g=j?r&&f:!0,d=j?g:!0,H=j?I:+h==2,l=a.useRef(null),[V,T]=a.useState(!1),[X,Y]=a.useState(null),[ct,$]=a.useState(null),[Z,W]=a.useState({orderBy:"-".concat(ie[se])}),[w,lt]=a.useState(!0),[_,J]=a.useState([]),[nt,L]=a.useState(0),[st,R]=a.useState(!1),[at,B]=a.useState(""),[U,z]=a.useState(""),[ot,mt]=a.useState(!1),[dt,yt]=a.useState(!1),[pt,Bt,Pt]=ys(ie,se,Z,W),It=(e,C)=>{var tt,Rt,jt;if(+C<0)return;const v=_.find(xt=>{const{node:Ct}=xt;return Ct.id===e}),b=((tt=v==null?void 0:v.node)==null?void 0:tt.quantity)||"";lt(+b==+C);const gt=((Rt=l.current)==null?void 0:Rt.getList())||[],it=gt==null?void 0:gt.map(xt=>{const{node:Ct}=xt;return(Ct==null?void 0:Ct.id)===e&&(Ct.quantity="".concat(+C),Ct.disableCurrentCheckbox=+C==0),xt}),Lt=it.filter(xt=>+xt.node.quantity==0);mt(Lt.length===it.length),(jt=l.current)==null||jt.setList([...it])},Tt=()=>{var e;(e=l.current)==null||e.refresh()};a.useImperativeHandle(s,()=>({initSearch:Tt,getList:()=>{var e;return(e=l.current)==null?void 0:e.getList()},setList:()=>{var e;return(e=l.current)==null?void 0:e.setList()},getSelectedValue:()=>{var e;return(e=l.current)==null?void 0:e.getSelectedValue()}}));const Ot=async e=>{W({...Z,search:e})},Dt=()=>{$(""),T(!1)},c=(e,C,v)=>{$(v),Y(e),T(!0)},N=async e=>{u(!0);const C=j?Zt:te;try{const v=Gt(e[0].newSelectOptionList,e[0]),b={itemId:ct,shoppingListId:A,itemData:{variantId:e[0].variantId,quantity:e[0].quantity,optionList:v||[]}};await C(b),T(!1),$(""),O.success(n("shoppingList.table.productUpdated")),Tt()}finally{u(!1)}},M=async e=>{var jt;const v=(((jt=l.current)==null?void 0:jt.getList())||[]).find(xt=>{const{node:Ct}=xt;return Ct.itemId===e});let b;v&&(b=v.node);const it=JSON.parse((b==null?void 0:b.optionList)||"[]").map(xt=>({optionId:xt.option_id,optionValue:xt.option_value})),Lt={variantId:b==null?void 0:b.variantId,quantity:b!=null&&b.quantity?+b.quantity:0,optionList:it||[],productNote:U};await(j?Zt:te)({itemId:e,shoppingListId:A,itemData:Lt})},q=async e=>{if(!w){u(!0);try{await M(e),O.success(n("shoppingList.table.quantityUpdated")),lt(!0),Tt()}finally{u(!1)}}},rt=e=>{var C;if(e.length>0){const v=((C=l.current)==null?void 0:C.getList())||[],b=[];e.forEach(gt=>{const it=v.find(Lt=>{const{node:tt}=Lt;return tt.id===gt});it&&b.push(it)}),m([...b])}else m([])},ft=()=>{R(!1),B(""),z("")},ut=async()=>{u(!0);try{ft(),await M(at),O.success(n("shoppingList.table.productNotesUpdated")),Tt()}finally{u(!1)}};a.useEffect(()=>{if(o){const{products:{edges:e},grandTotal:C,totalTax:v}=o,b=x?+C:+C-+v||0,gt=e.some(it=>{var Lt,tt;return(Lt=it==null?void 0:it.node)!=null&&Lt.productsSearch&&((tt=it.node.productsSearch)==null?void 0:tt.isPriceHidden)||!1});yt(gt),J(ve(e)),L(b)}},[o,x]),a.useEffect(()=>{if(o){const{products:{edges:e}}=o,C=e.filter(v=>v.node.quantity===0);mt(C.length===e.length)}},[o]);const St=(e,C)=>{const{productsSearch:{isPriceHidden:v}}=C;return v?"":We({price:e,productInfo:C,showText:v?"":e,forcedSkip:!0})},_t=[{key:"Product",title:n("shoppingList.table.product"),render:e=>{const C={...e.productsSearch,selectOptions:e.optionList},v=Jt(C,{}),b=JSON.parse(e.optionList),gt=v.filter(tt=>tt.valueText),it=C.variants||[],Lt=Le(it,{variantId:e.variantId,variantSku:e.variantSku})||e.primaryImage;return t.jsxs(p,{sx:{display:"flex",alignItems:"flex-start"},children:[t.jsx(qs,{src:Lt||Ut,alt:"Product-img",loading:"lazy"}),t.jsxs(p,{children:[t.jsx(F,{variant:"body1",color:"#212121",onClick:()=>{const{location:{origin:tt}}=window;window.location.href="".concat(tt).concat(e.productUrl)},sx:{cursor:"pointer"},children:e.productName}),t.jsx(F,{variant:"body1",color:"#616161",children:e.variantSku}),b.length>0&&gt.length>0&&t.jsx(p,{children:gt.map(tt=>t.jsx(F,{sx:{fontSize:"0.75rem",lineHeight:"1.5",color:"#455A64"},children:"".concat(tt.valueLabel,": ").concat(tt.valueText)},tt.valueLabel))}),(e==null?void 0:e.productNote)&&(e==null?void 0:e.productNote.trim().length)>0&&t.jsx(F,{sx:{fontSize:"0.75rem",color:"#ED6C02",marginTop:"0.3rem"},children:e.productNote})]})]})},width:"45%",isSortable:!0},{key:"Price",title:n("shoppingList.table.price"),render:e=>{const{basePrice:C,taxPrice:v=0}=e,b=Vt(+C,+v);return t.jsx(F,{sx:{padding:"12px 0"},children:St(At(b),e)})},width:"15%",style:{textAlign:"right"}},{key:"Qty",title:n("shoppingList.table.quantity"),render:e=>t.jsx(Es,{size:"small",type:"number",variant:"outlined",sx:{width:"72px"},disabled:d?Q||G:!0,value:e.quantity,inputProps:{inputMode:"numeric",pattern:"[0-9]*"},onChange:C=>{It(e.id,C.target.value)},onBlur:()=>{q(e.itemId)}}),width:"15%",style:{textAlign:"right"},isSortable:!0},{key:"Total",title:n("shoppingList.table.total"),render:e=>{const{basePrice:C,quantity:v,itemId:b,productsSearch:{options:gt},taxPrice:it=0}=e,tt=Vt(+C,+it)*+v,jt=(gt||JSON.parse(e.optionList)).length>0&&!Q&&!G&&d;return t.jsxs(p,{children:[t.jsx(F,{sx:{padding:"12px 0"},children:St(At(tt),e)}),t.jsx(p,{sx:{marginTop:"1rem",opacity:0,textAlign:i?"end":"start",display:"flex",justifyContent:"flex-end"},id:"shoppingList-actionList",children:g&&t.jsxs(t.Fragment,{children:[t.jsx(ht,{item:!0,sx:{marginRight:"0.5rem",minWidth:"32px"},children:t.jsx(fe,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{R(!0),B(+b),e.productNote&&z(e.productNote)}})}),t.jsx(ht,{item:!0,sx:{marginRight:jt?"0.5rem":"",marginLeft:jt?"0.3rem":""},children:jt&&t.jsx(ye,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{const{productsSearch:xt,variantId:Ct,itemId:Ce,optionList:be,quantity:je}=e;c({...xt,selectOptions:be,quantity:je},Ct,Ce)}})}),t.jsx(ht,{item:!0,sx:{marginLeft:"0.3rem"},children:d&&!Q&&!G&&t.jsx(Mt,{sx:{cursor:"pointer",color:"rgba(0, 0, 0, 0.54)"},onClick:()=>{D(!0),K(+b)}})})]})})]})},width:"15%",style:{textAlign:"right"}}];return t.jsxs(Ds,{children:[t.jsxs(p,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",margin:"0 0 1rem 0"},children:[t.jsx(F,{sx:{fontSize:"24px"},children:n("shoppingList.table.totalProductCount",{quantity:((Qt=o==null?void 0:o.products)==null?void 0:Qt.totalCount)||0})}),t.jsx(F,{sx:{fontSize:"24px"},children:dt?"":"".concat(At(nt||0))})]}),t.jsx(p,{sx:{marginBottom:"5px"},children:t.jsx(Ss,{searchBGColor:"rgba(0, 0, 0, 0.06)",handleChange:e=>{Ot(e)}})}),t.jsx(He,{ref:l,columnItems:_t,rowsPerPageOptions:[10,20,50],getRequestList:E,searchParams:Z,isCustomRender:!1,showCheckbox:!0,showSelectAllCheckbox:!0,applyAllDisableCheckbox:!1,disableCheckbox:ot||(H?!(P||S):(Q||G)&&d),hover:!0,labelRowsPerPage:n("shoppingList.table.itemsPerPage"),showBorder:!1,requestLoading:u,getSelectCheckbox:rt,itemIsMobileSpacing:0,noDataText:n("shoppingList.table.noProductsFound"),sortDirection:Bt,orderBy:Pt,sortByFn:pt,pageType:"shoppingListDetailsTable",renderItem:(e,C,v)=>{var b;return t.jsx(Os,{len:((b=o==null?void 0:o.products)==null?void 0:b.edges.length)||0,item:e,itemIndex:C,showPrice:St,onEdit:c,onDelete:K,checkBox:v,setDeleteOpen:D,setAddNoteOpen:R,setAddNoteItemId:B,setNotes:z,handleUpdateProductQty:It,handleUpdateShoppingListItem:q,isReadForApprove:Q||G,b2bAndBcShoppingListActionsPermissions:d})}}),t.jsx(ls,{isOpen:V,isLoading:y,setIsLoading:u,product:X,type:"shoppingList",onCancel:Dt,onConfirm:N,isEdit:!0,isB2BUser:j}),t.jsx(ws,{open:st,notes:U,setNotes:z,handleCancelAddNotesClick:ft,handleAddItemNotesClick:ut})]})}const Fs=a.forwardRef(Ns);function Qs({setOpenPage:k}){const{id:s=""}=fs(),{state:{openAPPParams:i,productQuoteEnabled:n=!1}}=a.useContext(pe),o=et(Je),{currency_code:y}=et(oe),u=et(({company:c})=>c.customer.role),A=et(({company:c})=>c.companyInfo.id),E=et(({company:c})=>c.customer.customerGroupId),m=et(({company:c})=>c.permissions),Q=et(({b2bFeatures:c})=>c.masqueradeCompany.isAgenting),K=Se(),[D]=wt(),{dispatch:G}=a.useContext(me),j=Te(),P=kt(),S=j.palette.primary.main,f=a.useRef(null),[h,x]=a.useState([]),[r,I]=a.useState(null),[g,d]=a.useState(null),[H,l]=a.useState(0),[V,T]=a.useState(!1),[X,Y]=a.useState(!1),[ct,$]=a.useState(""),[Z,W]=a.useState([]),[w,lt]=a.useState([]),[_,J]=a.useState(!1),[nt,L]=a.useState(!0),{shoppingListActionsPermission:st,purchasabilityPermission:R,submitShoppingListPermission:at}=et(Ft),B=o?st&&nt:!0,U=o?R:!0,z=o?at:u===2,ot=(r==null?void 0:r.status)===0&&z,mt=(r==null?void 0:r.status)===40||(r==null?void 0:r.status)===20,dt=()=>{K("/shoppingLists")};a.useEffect(()=>{G({type:"init",payload:{id:parseInt(s,10)||0}})},[s]);const yt=async c=>{if(c.length>0)try{const N=[];c.forEach(ft=>{const{node:ut}=ft;N.includes(ut.productId)||N.push(ut.productId)});const M=o?ue:he,{productsSearch:q}=await M({productIds:N,currencyCode:y,companyId:A,customerGroupId:E}),rt=ge(q);return c.forEach(ft=>{const{node:ut}=ft,St=rt.find(_t=>{const{id:Qt}=_t;return ut.productId===Qt});ut.productsSearch=St||{},ut.productName=(St==null?void 0:St.name)||ut.productName,ut.productUrl=(St==null?void 0:St.productUrl)||ut.productUrl,ut.disableCurrentCheckbox=!1,ut.quantity===0&&(ut.disableCurrentCheckbox=!0)}),c}catch(N){O.error(N)}return[]},pt=async c=>{const N=o?await Xe({id:s,...c}):await Ye({id:s,...c}),{products:{edges:M,totalCount:q}}=N,rt=await yt(M);return await xe(rt,"2"),o&&d(N.customerInfo),I(N),rt?{edges:rt,totalCount:q}:{edges:[],totalCount:0}},Bt=async c=>{var N;T(!0);try{const M={id:+s,name:(r==null?void 0:r.name)||"",description:(r==null?void 0:r.description)||""};o?await Ze({...M,status:c}):await ts({...M,channelId:es}),O.success(P("shoppingList.shoppingListStatusUpdated"),{isClose:!0}),(N=f.current)==null||N.initSearch()}finally{T(!1)}},Pt=()=>{var c;(c=f.current)==null||c.initSearch()},It=()=>{Y(!1),$("")},Tt=async(c="")=>{T(!0);const N=o?is:ns;try{if(c){if(await N({itemId:c,shoppingListId:s}),h.length>0){const M=h.filter(q=>{const{itemId:rt}=q.node;return c!==rt});x([...M])}}else{if(h.length===0)return;h.forEach(async M=>{const{node:q}=M;await N({itemId:q.itemId,shoppingListId:s})}),x([])}O.success(P("shoppingList.productRemoved"))}finally{T(!1),Pt()}};a.useEffect(()=>{if(h.length>0){let c=0;h.forEach(N=>{const{node:{quantity:M,basePrice:q,taxPrice:rt}}=N,ft=Vt(+q,+rt);c+=ft*+M}),l(1e3*c/1e3)}else l(0)},[h]);const Ot=async()=>{await Tt(+ct),await It()},Dt=async()=>{const{storeConfigSwitchStatus:{isEnabled:c}}=await ss();J(c==="1"&&U)};return a.useEffect(()=>{ot&&Dt()},[ot]),a.useEffect(()=>{if(o&&r){const c=m.find(q=>q.code==="deplicate_shopping_list"),N=[];if(c&&!Ae(c)){const q=c.permissionLevel,rt=(r==null?void 0:r.isOwner)||!1;N.push({permissionType:"shoppingListActionsPermission",permissionLevel:q===1&&rt?q:2})}const{shoppingListActionsPermission:M}=Ke(N);L(M)}},[r,o]),t.jsxs(t.Fragment,{children:[t.jsxs(p,{sx:{display:"flex",flexDirection:"column",flex:1},children:[t.jsx(As,{isB2BUser:o,shoppingListInfo:r,customerInfo:g,role:u,goToShoppingLists:dt,handleUpdateShoppingList:Bt,setOpenPage:k,isAgenting:Q,openAPPParams:i,customColor:S}),t.jsxs(ht,{container:!0,spacing:2,sx:{marginTop:"0",overflow:"auto",flexWrap:D?"wrap":"nowrap",paddingBottom:"20px",marginBottom:D?"6rem":0},children:[t.jsx(p,{sx:D?{flexBasis:"100%",pl:"16px"}:{flexBasis:"690px",flexGrow:1,ml:"16px",pt:"16px"},children:t.jsx(ae,{isSpinning:V,spinningHeight:"auto",children:t.jsx(ht,{item:!0,sx:D?{flexBasis:"100%"}:{flexBasis:"690px",flexGrow:1},children:t.jsx(Fs,{ref:f,isReadForApprove:mt,isJuniorApprove:ot,allowJuniorPlaceOrder:_,setCheckedArr:x,shoppingListInfo:r,isRequestLoading:V,setIsRequestLoading:T,shoppingListId:s,getShoppingListDetails:pt,setDeleteOpen:Y,setDeleteItemId:$,isB2BUser:o,productQuoteEnabled:n,isCanEditShoppingList:nt,role:u})})})}),t.jsx(ht,{item:!0,sx:D?{flexBasis:"100%"}:{flexBasis:"340px"},children:B&&!mt&&!ot&&t.jsx(Cs,{updateList:Pt,type:"shoppingList",isB2BUser:o})})]}),!mt&&(_||n||!ot)&&t.jsx(Ts,{shoppingListInfo:r,allowJuniorPlaceOrder:_,checkedArr:h,selectedSubTotal:H,setLoading:T,setDeleteOpen:Y,setValidateFailureProducts:lt,setValidateSuccessProducts:W,isB2BUser:o,customColor:S,isCanEditShoppingList:nt,role:u})]}),t.jsx(Ps,{shoppingListInfo:r,role:u,products:w,successProducts:Z.length,allowJuniorPlaceOrder:_,setValidateFailureProducts:lt,setValidateSuccessProducts:W,textAlign:D?"left":"right"}),t.jsx(Is,{open:X,handleCancelClick:It,handleDeleteProductClick:Ot})]})}function gi({setOpenPage:k}){return t.jsx(ds,{children:t.jsx(Qs,{setOpenPage:k})})}export{gi as default};
