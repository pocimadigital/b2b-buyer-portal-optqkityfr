import{j as t,B as v,a0 as _e,T as ke,v as Oe,ai as Ue,w as Me,aj as Te,y as He,ak as We,al as Ke,am as qe,I as De}from"./mui-CyG7s_nf.js";import{r as c}from"./reactVendor-BAhb8EbJ.js";import{u as xe}from"./lang-DxTEvHWx.js";import{B as Ge}from"./B3Card-CsmmQPOq.js";import{bq as be,G as Re,C as Ce,k as he,a6 as ge,a8 as Se,br as $e,bm as Je,u as Ne,bs as Pe,a as Ie,W as fe,N as Ve,bt as Qe,a2 as Xe,a4 as Ye,ac as Ze,x as et}from"./react-setup-CGfEmvbO.js";import{b as ue}from"./b3Logger-CMQiGC3f.js";import"../index.BYdqPMNb.js";import{l as tt}from"./b3Login-DA7LbQgM.js";import{c as ot}from"./login-DOCia5GV.js";import{l as at}from"./config-B6kdboQ0.js";import{d as pe,t as nt,B as Fe,e as st,s as rt,b as it,g as ve,c as ct}from"./config-DgTXSd-v.js";import{n as lt}from"./eStyled-B3rIBjaz.js";import{u as je}from"./form-Bvi8lP6x.js";import{B as ye}from"./B3CustomForm-JRB-A4C2.js";import{T as Ee,R as Le,c as dt,s as ut,I as Be,v as mt,a as ft,b as pt,d as gt,e as ht}from"./RegisteredFinish-eH7VMjhz.js";import{C as yt,g as xt}from"./recaptcha-B7uTWrRQ.js";import{a as bt,c as Ft}from"./users-DVrOJSjo.js";import{i as Ct}from"./lodashEs-Ck10JMnh.js";import{u as It}from"./router-BbCjXwHs.js";import"./eReact-DeS39u1B.js";import"./intl-CIPMD0ue.js";import"./eCache-BQInSoPa.js";import"./redux-B-shcavw.js";import"./toolkit-CHPG993j.js";import"./muiIcon-BfPleEzf.js";import"./dateFns-BB2kaHor.js";import"./dropzone-D4lSiSJA.js";import"./validatorRules--6EJQDZH.js";function wt(Q){const B=xe(),{handleBack:k,activeStep:z,handleNext:q}=Q,[_,C]=c.useState([]),[N,O]=c.useState(""),[g,U]=c.useState(""),[J,X]=c.useState(""),[H,P]=c.useState(!1),[M,Z]=c.useState(""),[Y,ee]=c.useState(!1),I=m=>X(m);c.useEffect(()=>{(async()=>{try{const s=await xt();s&&(P(s.isEnabledOnStorefront),Z(s.siteKey))}catch(s){ue.error(s)}})()},[]),c.useEffect(()=>{J&&ee(!1)},[J]);const{control:ce,handleSubmit:ie,setError:te,formState:{errors:ne}}=je({mode:"all"}),{state:D,dispatch:V}=c.useContext(be),{state:{blockPendingAccountOrderCreation:W}}=c.useContext(Re),{state:{portalStyle:{backgroundColor:se="#FEF9F5"}}}=c.useContext(Ce),x=he(se),{contactInformation:R,bcContactInformation:j,passwordInformation:p=[],bcPasswordInformation:E=[],accountType:w,additionalInformation:oe,bcAdditionalInformation:le,addressBasicFields:G=[],bcAddressBasicFields:K=[],companyInformation:l=[],emailMarketingNewsletter:b}=D,h=w==="1"?R:j,$=w==="1"?p:E,T=w==="1"?oe:le,u=w==="1"?G:K;c.useEffect(()=>{if(w){if(h&&h.length){const m=h.find(s=>s.name==="email")||{};U((m==null?void 0:m.default)||"")}C($)}},[R,j,w,h,$]);const r=m=>{const s={};if(s.authentication={force_password_reset:!1,new_password:m.password},s.accepts_product_review_abandoned_cart_emails=b,h&&(h.forEach(o=>{var e;const d=pe(o.name);d==="accepts_marketing_emails"?s.accepts_product_review_abandoned_cart_emails=!!((e=o==null?void 0:o.default)!=null&&e.length):o.custom||(s[d]=(o==null?void 0:o.default)||"")}),s.form_fields=[],T&&T.length&&T.forEach(o=>{s.form_fields.push({name:o.bcLabel,value:o.default})})),s.addresses=[],s.origin_channel_id=ge,s.channel_ids=[ge],w==="2"){const o={},d=u.filter(n=>!n.custom),e=u.filter(n=>n.custom);d&&(s.addresses={},d.forEach(n=>{n.name==="country"?o.country_code=n.default:n.name==="state"?o.state_or_province=n.default:n.name==="postalCode"?o.postal_code=n.default:n.name==="firstName"?o.first_name=n.default:n.name==="lastName"?o.last_name=n.default:o[n.name]=n.default})),o.form_fields=[],e&&e.length&&e.forEach(n=>{o.form_fields.push({name:n.bcLabel,value:n.default})}),s.addresses=[o],s.trigger_account_created_notification=!0}const L={storeHash:Se,...s};return dt(L)},y=async(m,s,L)=>{try{const o={};o.customerId=s||"",o.storeHash=Se;const e=(h||[]).filter(a=>!!a.custom);if(e.length){const a=[];e.forEach(f=>{const S={};S.fieldName=pe(f.name),S.fieldValue=(f==null?void 0:f.default)||"",a.push(S)}),o.userExtraFields=a}const n=l.filter(a=>!a.custom&&a.fieldType!=="files"),i=l.filter(a=>!!a.custom);if(n.length&&n.forEach(a=>{o[nt(pe(a.name))]=(a==null?void 0:a.default)||""}),i.length){const a=[];i.forEach(f=>{const S={};S.fieldName=pe(f.name),S.fieldValue=(f==null?void 0:f.default)||"",a.push(S)}),o.extraFields=a}const F=u.filter(a=>!a.custom)||[],A=u.filter(a=>!!a.custom)||[];if(F.length&&F.forEach(a=>{const f=pe(a.name);f==="address1"&&(o.addressLine1=a.default),f==="address2"&&(o.addressLine2=a.default),o[f]=a.default}),A.length){const a=[];A.forEach(f=>{const S={};S.fieldName=pe(f.name),S.fieldValue=(f==null?void 0:f.default)||"",a.push(S)}),o.addressExtraFields=a}return o.fileList=L,o.channelId=ge,await $e(o)}catch(o){ue.error(o)}},ae=async m=>{let s=[];if(m.length){m.forEach(L=>{s=L.default});try{return(await Promise.all(s.map(d=>Je({file:d,type:"companyAttachedFile"})))).reduce((d,e)=>{let n=d;if(e.code===200){const i={...e.data};i.fileSize=i.fileSize?"".concat(i.fileSize):"",n=[...d,i]}else throw e.data.errMsg||e.message||B("intl.global.fileUpload.fileUploadFailure");return n},[])}catch(L){throw ue.error(L),L}}},re=m=>{const s=p.map(o=>{const d=o;return w==="1"&&(d.default=m[o.name]||o.default),o}),L=E.map(o=>{const d=o;return w==="2"&&(d.default=m[o.name]||o.default),o});V({type:"all",payload:{passwordInformation:s,bcPasswordInformation:L}})},de=async()=>{if(h&&h.length>0){const m=h.find(e=>e.fieldId==="field_email_marketing_newsletter"&&e.fieldType==="checkbox"),s=h.find(e=>e.fieldId==="field_first_name")||{},L=h.find(e=>e.fieldId==="field_last_name")||{},o=(m==null?void 0:m.isChecked)||!1,d=(m==null?void 0:m.default)||[];if(o&&d.length>0)try{await ut({storeHash:Se,email:g,first_name:s.default,last_name:L.default,channel_id:ge||1})}catch(e){O((e==null?void 0:e.message)||e)}}},me=m=>{ie(async s=>{var L,o;if(s.password!==s.confirmPassword){te("confirmPassword",{type:"manual",message:B("global.registerComplete.passwordMatchPrompt")}),te("password",{type:"manual",message:B("global.registerComplete.passwordMatchPrompt")});return}if(H&&!J){ee(!0);return}if(!Y)try{V({type:"loading",payload:{isLoading:!0}});let d=!0;if(w==="2")await r(s);else{const e=l.filter(f=>f.fieldType==="files"),n=await ae(e||[]),i=await r(s),{data:F}=i,A=await y(s,F.id,n);d=+(((o=(L=A==null?void 0:A.companyCreate)==null?void 0:L.company)==null?void 0:o.companyStatus)||"")==1}V({type:"finishInfo",payload:{submitSuccess:!0,isAutoApproval:d,blockPendingAccountOrderCreation:W}}),re(s),await de(),q()}catch(d){O((d==null?void 0:d.message)||d)}finally{V({type:"loading",payload:{isLoading:!1}})}})(m)};return t.jsxs(v,{sx:{pl:1,pr:1,mt:2,width:"100%","& h4":{color:x},"& input, & .MuiFormControl-root .MuiTextField-root":{borderRadius:"4px",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",padding:"10px !important"}},children:[N&&t.jsx(_e,{severity:"error",children:t.jsx(Ee,{children:N})}),t.jsxs(v,{children:[_&&t.jsxs(t.Fragment,{children:[g.length>0&&t.jsx(v,{sx:{fontSize:"16px",fontWeight:400,color:"#000000",marginBottom:"10px",marginTop:"-12px",wordWrap:"break-word",textAlign:"center"},children:"Ahora por favor crea una contraseÃ±a para tu cuenta: ".concat(g)}),t.jsx(ye,{formFields:_,errors:ne,control:ce})]}),Y?t.jsx(ke,{variant:"body1",sx:{display:"flex",alignSelf:"flex-start",marginLeft:"8px",marginTop:"2px",fontSize:"13px"},children:B("login.loginText.missingCaptcha")}):"",H?t.jsx(v,{sx:{display:"flex",justifyContent:"center",marginTop:"20px"},children:t.jsx(yt,{siteKey:M,size:"normal",handleGetKey:I})}):""]}),t.jsx(Le,{handleBack:k,activeStep:z,handleNext:me,email:g})]})}function St(Q){var G,K;const{handleBack:B,handleNext:k,activeStep:z}=Q,{state:q,dispatch:_}=c.useContext(be),C=Ne(Pe),{state:{accountLoginRegistration:N,portalStyle:{backgroundColor:O="#FEF9F5"}}}=c.useContext(Ce),g=he(O),U=xe(),[J]=Ie(),[X,H]=c.useState(""),{contactInformation:P,accountType:M,additionalInformation:Z,bcContactInformation:Y,bcAdditionalInformation:ee}=q,{control:I,handleSubmit:ce,getValues:ie,formState:{errors:te},setError:ne,setValue:D}=je({mode:"onSubmit"}),V=M==="1"?"additionalInformation":"bcAdditionalInformation",W=M==="1"?Z||[]:ee||[],se=P==null?void 0:P.map(l=>{const b=l;return l.fieldId==="field_email"&&M==="1"&&(b.isTip=!1),l}),x=M==="1"?se:Y||[],R=M==="1"?"contactInformation":"bcContactInformationFields",j=W.length?(G=W[0])==null?void 0:G.groupName:"",p=(l=!1)=>{_({type:"loading",payload:{isLoading:l}})},E=l=>{_({type:"accountType",payload:{accountType:l.target.value}})},w=((K=P==null?void 0:P.find(l=>l.fieldId==="field_email"))==null?void 0:K.name)||"email",oe=async l=>{const b=M==="1";try{p(!0);const{isValid:h,userType:$,userInfo:{companyName:T=""}={}}=b?await bt({email:l,channelId:ge}):await Ft({email:l,channelId:ge});return h?H(""):(H(U(st[$],{companyName:T||"",email:l})),ne(w,{type:"custom",message:""}),C==null||C.body.scrollIntoView(!0)),h}catch(h){return!1}finally{p(!1)}},le=async l=>{ce(async b=>{var T;if(!await oe(b[w]))return;const h=x.map(u=>{const r=u;return r.default=b[u.name]||u.default,u.fieldId==="field_email_marketing_newsletter"&&u.fieldType==="checkbox"&&(r.isChecked=b[u.name].length>0),u});try{if(p(!0),M==="1"){const u=h.filter(y=>!!y.custom),r=u.map(y=>({fieldName:Fe.decode(y.name),fieldValue:b[y.name]||y.default}));if(r.length>0){const y=await mt({extraFields:r});if(y.code!==200){const ae=((T=y.data)==null?void 0:T.errMsg)||y.message||"",re=ae.split(":");if(re.length>=2){const de=u.find(me=>Fe.decode(me.name)===re[0]);if(de){ne(de.name,{type:"manual",message:re[1]}),p(!1);return}}H(ae),p(!1);return}}H("")}}catch(u){ue.error(u)}finally{p(!1)}let $=[];W&&($=W.map(u=>{const r=u;return r.default=b[u.name]||u.default,u})),_({type:"all",payload:{[V]:[...$],[R]:[...h]}}),k()})(l)};return t.jsxs(v,{sx:{pl:1,pr:1,mt:2,width:"100%"},children:[X&&t.jsx(_e,{severity:"error",children:t.jsx(Ee,{children:X})}),t.jsx(v,{component:"div",sx:{color:"#000000",fontFamily:"Montserrat",fontStyle:"normal",fontWeight:400,lineHeight:"normal",fontSize:J?"0.875rem":"1rem",textAlign:J?"center":"center ",padding:"0px 15px"},dangerouslySetInnerHTML:{__html:U("register.step.account.customText")}}),t.jsx(Oe,{sx:{"& h4":{color:g}},children:t.jsxs(Ue,{"aria-labelledby":"demo-row-radio-buttons-group-label",name:"row-radio-buttons-group",value:M,onChange:E,sx:{display:"none","& .MuiTypography-root.MuiTypography-body1.MuiFormControlLabel-label":{color:fe(g,.87)},"& .MuiButtonBase-root.MuiRadio-root.MuiRadio-colorPrimary:not(.Mui-checked)":{color:fe(g,.6)}},children:[N.b2b&&t.jsx(Me,{value:"1",control:t.jsx(Te,{}),label:U("register.registeredAccount.businessAccount")}),N.b2c&&t.jsx(Me,{value:"2",control:t.jsx(Te,{}),label:U("register.registeredAccount.personalAccount")})]})}),t.jsx(v,{sx:{"& h4":{color:g},"& input, & .MuiFormControl-root .MuiTextField-root, & .MuiTextField-root .MuiInputBase-multiline":{borderRadius:"4px",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",padding:"10px !important"},"& .MuiButtonBase-root.MuiCheckbox-root.MuiCheckbox-colorPrimary:not(.Mui-checked)":{color:fe(g,.6)},"& .MuiTypography-root.MuiTypography-body1.MuiFormControlLabel-label":{color:fe(g,.87)}},children:t.jsx(ye,{formFields:x,errors:te,control:I,getValues:ie,setValue:D})}),t.jsx(v,{}),W&&W.length?t.jsxs(v,{sx:{"& h4":{color:g},"& .MuiFormControlLabel-label, & .MuiFormControl-root .MuiFormLabel-root:not(.Mui-focused)":{color:fe(g,.87)},"& .MuiRadio-root:not(.Mui-checked)":{color:fe(g,.6)}},children:[t.jsx(Be,{children:j}),t.jsx(ye,{formFields:W,errors:te,control:I,getValues:ie,setValue:D})]}):"",t.jsx(Le,{activeStep:z,handleBack:B,handleNext:le})]})}function Bt(Q){var de,me,m,s,L,o,d;const B=xe(),[k]=Ie(),{handleBack:z,handleNext:q,activeStep:_}=Q,{state:C,dispatch:N}=c.useContext(be),O=C.contactInformation||[],g=C.companyInformation||[],U=((de=O.find(e=>e.fieldId==="field_first_name"))==null?void 0:de.default)||"",J=((me=O.find(e=>e.fieldId==="field_last_name"))==null?void 0:me.default)||"",X="".concat(U," ").concat(J).trim(),H=g.find(e=>e.fieldId==="field_company_name");H&&(H.default=X);const P=((m=O.find(e=>e.fieldId==="field_email"))==null?void 0:m.default)||"",M=g.find(e=>e.fieldId==="field_company_email");M&&(M.default=P);const Z=((s=O.find(e=>e.fieldId==="field_phone_number"))==null?void 0:s.default)||"",Y=g.find(e=>e.fieldId==="field_company_phone_number");Y&&(Y.default=Z);const ee=((L=O.find(e=>e.label==="CÃ©dula profesional"))==null?void 0:L.default)||"",I=g.find(e=>e.label==="CÃ©dula profesional");I&&(I.default=ee);const{state:{portalStyle:{backgroundColor:ce="#FEF9F5"}}}=c.useContext(Ce),ie=he(ce),[te,ne]=c.useState(""),{accountType:D="1",companyInformation:V=[],companyAttachment:W=[],addressBasicFields:se=[],bcAddressBasicFields:x=[],countryList:R=[]}=C,{control:j,handleSubmit:p,getValues:E,formState:{errors:w},setValue:oe,watch:le,setError:G}=je({mode:"all"}),K=D==="1"?(o=V[0])==null?void 0:o.groupName:"",l=D==="1"?"addressBasicFields":"bcAddressBasicFields",b=D==="1"?se:x,h=((d=b[0])==null?void 0:d.groupName)||"",$=c.useCallback((e,n="")=>{var A;const i=((A=R.find(a=>a.countryCode===e||a.countryName===e))==null?void 0:A.states)||[],F=b.find(a=>a.name==="state");F&&(i.length>0?(F.fieldType="dropdown",F.options=i):(F.fieldType="text",F.options=[])),oe("state",n&&e&&(i.find(a=>a.stateName===n)||i.length===0)?n:""),N({type:"stateList",payload:{stateList:i,addressBasicFields:se,bcAddressBasicFields:x,[l]:[...b]}})},[se,b,l,x,R]);c.useEffect(()=>{const e=E("country"),n=E("state");$(e,n)},[]),c.useEffect(()=>{const e=le((n,{name:i,type:F})=>{const{country:A,state:a}=n;i==="country"&&F==="change"&&$(A,a)});return()=>e.unsubscribe()},[R,$]);const T=(e=!1)=>{N({type:"loading",payload:{isLoading:e}})},u=(e,n)=>e.map(i=>{const F=i;return F.default=n[i.name]||i.default,i}),r=()=>{const e=[...V,...W,...b].reduce((A,a)=>{const f=A;return f[a.name]=E(a.name)||a.default,A},{}),n=u(V,e),i=u(W,e),F=u(b,e);N({type:"all",payload:{companyInformation:[...n],companyAttachment:[...i],[l]:[...F]}})},y=()=>{var e;if(D==="1"){const n=E(),i=V.find(F=>F.fieldId==="field_attachments");if(!Ct(i)&&i.required&&n[i.name].length===0)return G(i.name,{type:"required",message:B("global.validate.required",{label:(e=i.label)!=null?e:""})}),T(!1),!0}return!1},ae=e=>{const n=y();p(async i=>{var F;if(!n){T(!0);try{if(D==="1"){const A=V.filter(S=>!!S.custom),a=A.map(S=>({fieldName:Fe.decode(S.name),fieldValue:i[S.name]||S.default})),f=await ft({extraFields:a});if(f.code!==200){const S=((F=f.data)==null?void 0:F.errMsg)||f.message||"",we=S.split(":");if(we.length>=2){const Ae=A.find(ze=>Fe.decode(ze.name)===we[0]);if(Ae){G(Ae.name,{type:"manual",message:we[1]}),T(!1);return}}ne(S),T(!1);return}ne("")}r(),T(!1),q()}catch(A){T(!1)}}})(e)},re=()=>{r(),z()};return t.jsxs(v,{sx:{pl:1,pr:1,mt:2,width:"100%","& h4":{color:ie},"& input, & .MuiFormControl-root .MuiTextField-root, & .MuiDropzoneArea-textContainer, & .MuiSelect-select.MuiSelect-outlined, & .MuiTextField-root .MuiInputBase-multiline":{borderRadius:"4px",borderBottomLeftRadius:"0",borderBottomRightRadius:"0",padding:"10px !important"}},children:[te&&t.jsx(_e,{severity:"error",children:t.jsx(Ee,{children:te})}),t.jsx(v,{component:"div",sx:{color:"#000000",fontFamily:"Montserrat",fontStyle:"normal",fontWeight:400,lineHeight:"normal",fontSize:k?"0.875rem":"1rem",textAlign:k?"center":"center ",padding:"0px 15px"},dangerouslySetInnerHTML:{__html:B("register.step.details.customText")}}),D==="1"?t.jsxs(v,{sx:{display:"none !important"},children:[t.jsx(Be,{children:K}),t.jsx(ye,{formFields:[...V],errors:w,control:j,getValues:E,setValue:oe,setError:G})]}):null,t.jsxs(v,{children:[t.jsx(Be,{children:h}),t.jsx(ye,{formFields:b,errors:w,control:j,getValues:E,setValue:oe})]}),t.jsx(Le,{handleBack:re,handleNext:ae,activeStep:_})]})}const _t=lt(v)({"& #b3-customForm-id-name":{'& label[data-shrink="true"]':{whiteSpace:"break-spaces",transition:"unset",background:"white"},'& label[data-shrink="false"]':{whiteSpace:"break-spaces",color:"#474747",fontFamily:"Montserrat",fontSize:"0.9375rem",fontStyle:"normal",fontWeight:400,lineHeight:"normal",top:"-4px",background:"white"}}});function jt(Q){const{activeStep:B,handleBack:k,handleNext:z,handleFinish:q}=Q,_=C=>{switch(C){case 0:return t.jsx(St,{activeStep:B,handleBack:k,handleNext:z});case 1:return t.jsx(Bt,{activeStep:B,handleBack:k,handleNext:z});case 2:return t.jsx(wt,{activeStep:B,handleBack:k,handleNext:z});case 3:return t.jsx(pt,{activeStep:B,handleFinish:q});default:return null}};return t.jsx(_t,{component:"div",children:_(B)})}function Et(Q){const{children:B,isStepOptional:k,activeStep:z,backgroundColor:q}=Q,_=xe(),[C]=Ie(),N=He(),{state:O}=c.useContext(be),{accountType:g,submitSuccess:U,isAutoApproval:J}=O,X=Ve.get("blockPendingAccountOrderCreation")&&!J,H=_(X?"register.title.registerCompleteWarning":"register.title.registerComplete"),P=g==="1"?H:_("register.title.accountCreated"),M=he(q);return t.jsxs(v,{component:"div",sx:{borderRadius:"4px",marginTop:"3px",background:"#FFFFFF",width:"100%",padding:C?"0 20px":"0 20%"},children:[t.jsx(v,{component:"h3",sx:{color:"#474747",fontFamily:"Montserrat",fontStyle:"normal",fontWeight:400,lineHeight:"normal",fontSize:C?"1.625rem":"2.5rem",textAlign:C?"center":"center "},children:U?P:_("register.title.accountRegister")}),!U&&t.jsx(We,{activeStep:z,sx:{display:"none","& .MuiSvgIcon-root:not(.Mui-active) .MuiStepIcon-text":{fill:he(M)},"& .MuiSvgIcon-root.Mui-active .MuiStepIcon-text":{fill:he(N.palette.primary.main)}},children:rt.map((Z,Y)=>{const ee={},I={};return k(Y)&&(I.optional=t.jsx(ke,{variant:"caption",children:_("register.step.optional")})),t.jsx(Ke,{...ee,children:t.jsx(qe,{...I,children:_(Z)})},Z)})}),B]})}const Lt=[1,2];function no(Q){const{setOpenPage:B}=Q,[k,z]=c.useState(0),q=xe(),[_]=Ie(),C=It(),N=Ne(Pe),{state:{isCheckout:O,isCloseGotoBCHome:g,logo:U,storeName:J,registerEnabled:X}}=c.useContext(Re),{state:{isLoading:H,accountType:P,contactInformation:M=[],passwordInformation:Z=[],bcPasswordInformation:Y=[],bcContactInformation:ee=[]},dispatch:I}=c.useContext(be),{state:{accountLoginRegistration:ce,portalStyle:{backgroundColor:ie="#FEF9F5"}}}=c.useContext(Ce);c.useEffect(()=>{X||C("/login")},[X]),c.useEffect(()=>{(async()=>{var R,j,p,E;try{I&&(I({type:"loading",payload:{isLoading:!0}}),I({type:"finishInfo",payload:{submitSuccess:!1}}));const w=Lt.map(r=>Ye(r)),oe=await Promise.all(w),le=(((R=oe[1])==null?void 0:R.accountFormFields)||[]).map(r=>{const y=r;return it.includes((r==null?void 0:r.fieldId)||"")&&r.groupId===4&&(y.isRequired=!0,y.visible=!0),r}),G=ve(((j=oe[0])==null?void 0:j.accountFormFields)||[]),K=ve(le||[]),{countries:l}=await Ze(),b=((p=K.address)==null?void 0:p.map(r=>{const y=r;return r.name==="country"&&(y.options=l,y.replaceOptions={label:"countryName",value:"countryName"}),r}))||[],h=((E=G.address)==null?void 0:E.map(r=>{const y=r;if(r.name==="country"){y.options=l;const ae=l.find(re=>re.countryName===r.default);y.default=(ae==null?void 0:ae.countryCode)||r.default}return r}))||[],{b2b:$,b2c:T}=ce;I&&I({type:"all",payload:{accountType:T&&!$?"2":"1",isLoading:!1,storeName:J,contactInformation:[...K.contactInformation||[]],bcContactInformation:[...G.contactInformation||[]],additionalInformation:[...K.additionalInformation||[]],bcAdditionalInformation:[...G.additionalInformation||[]],companyExtraFields:[],companyInformation:[...(K==null?void 0:K.businessDetails)||[]],companyAttachment:[...ct(q)],addressBasicFields:[...b],bcAddressBasicFields:[...h],countryList:[...l],passwordInformation:[...K.password||[]],bcPasswordInformation:[...G.password||[]]}})}catch(w){ue.error(w)}})()},[]);const te=x=>x===-1,ne=()=>{var j,p;const x=((j=(P==="1"?M:ee).find(E=>E.name==="email"))==null?void 0:j.default)||"",R=((p=(P==="1"?Z:Y).find(E=>E.name==="password"))==null?void 0:p.default)||"";return{emailAddress:x,password:R}},D=async()=>{z(x=>x+1)},V=()=>{z(x=>x-1)},W=()=>{I&&I({type:"all",payload:{accountType:"",isLoading:!1,storeName:"",submitSuccess:!1,contactInformation:[],additionalInformation:[],companyExtraFields:[],companyInformation:[],companyAttachment:[],addressBasicFields:[],addressExtraFields:[],countryList:[],passwordInformation:[]}})},se=async()=>{var R;I({type:"loading",payload:{isLoading:!0}});const x=ne();if(O)try{await at(x),window.location.reload()}catch(j){ue.error(j)}else try{const j={email:x.emailAddress,pass:x.password},{data:p}=await ot(j);if((R=p==null?void 0:p.login)!=null&&R.customer&&Ve.set("loginCustomer",{emailAddress:p.login.customer.email,phoneNumber:p.login.customer.phone,...p.login.customer}),await et(),W(),!tt(C))return;g?window.location.href="/":C("/orders")}catch(j){ue.error(j)}I({type:"loading",payload:{isLoading:!1}})};return c.useEffect(()=>{N==null||N.body.scrollIntoView(!0)},[k]),Qe(!1),t.jsx(Ge,{setOpenPage:B,children:t.jsx(gt,{isMobile:_,children:t.jsx(Xe,{isSpinning:H,tip:q("global.tips.loading"),transparency:"0",children:t.jsxs(v,{sx:{display:"flex",flexDirection:"column",width:"100%",alignItems:"center"},children:[U&&t.jsx(ht,{children:t.jsx(De,{sx:{maxWidth:"250px"},onClick:()=>{window.location.href="/"},children:t.jsx("img",{src:"".concat(U),alt:q("global.tips.registerLogo"),loading:"lazy"})})}),t.jsx(Et,{activeStep:k,isStepOptional:te,backgroundColor:ie,children:t.jsx(jt,{activeStep:k,handleBack:V,handleNext:D,handleFinish:se})})]})})})})}export{no as default};
