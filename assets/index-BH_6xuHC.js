import{j as e,B as i,y as fe,a0 as W,I as he,T as ye}from"./mui-CyG7s_nf.js";import{r as y}from"./reactVendor-BAhb8EbJ.js";import{u as be,d as we}from"./router-BbCjXwHs.js";import{u as N}from"./lang-DxTEvHWx.js";import{B as Fe}from"./B3Card-BPDFFC5Y.js";import{a as R,a3 as _,i as G,u as j,ar as Te,G as Ce,C as Le,as as je,a2 as Ie,n as Be,o as Se,a5 as U,at as Ae,au as Pe,av as He,aw as ke,a8 as Re,a6 as ve,w as De,ag as Me,ax as qe,ay as Ee,x as We,az as O,aa as z,aA as Ue,aB as Oe}from"./react-setup-5BSR6wiC.js";import{b as ze}from"./b3Logger-CMQiGC3f.js";import"../index.BYZwzzkf.js";import{l as Je}from"./b3Login-D1LhgavE.js";import{b as J,a as Ne}from"./login-OWu4HRBx.js";import{a as _e,l as Ge}from"./config-BITtSjox.js";import{u as Ve}from"./form-Bvi8lP6x.js";import{B as Qe}from"./B3CustomForm-BzcTvd60.js";import{a as Ye,L as $e}from"./styled-HeAq0rir.js";import"./eReact-DeS39u1B.js";import"./intl-CIPMD0ue.js";import"./eCache-BQInSoPa.js";import"./eStyled-B3rIBjaz.js";import"./redux-B-shcavw.js";import"./toolkit-CHPG993j.js";import"./lodashEs-Ck10JMnh.js";import"./muiIcon-BfPleEzf.js";import"./dateFns-BB2kaHor.js";import"./dropzone-D4lSiSJA.js";import"./validatorRules-SFapG1La.js";function k(l){const{html:c,sx:g}=l;return e.jsx(i,{sx:{...g},dangerouslySetInnerHTML:{__html:c}})}function Ke(l){const{loginBtn:c,handleLoginSubmit:g,gotoForgotPassword:x}=l,[p]=R(),a=N(),{control:d,handleSubmit:I,getValues:f,formState:{errors:t},setValue:A}=Ve({mode:"onSubmit"}),B=F=>{g(F)},w=_e(a,I(B));return e.jsx(i,{sx:{display:"flex",flexDirection:"column"},children:e.jsx(i,{sx:{width:"100%","& input":{bgcolor:"#F5F5F5",borderRadius:"4px",borderBottomLeftRadius:"0",borderBottomRightRadius:"0"}},children:e.jsxs("form",{onSubmit:I(B),children:[e.jsx(Qe,{formFields:w,errors:t,control:d,getValues:f,setValue:A}),e.jsxs(i,{sx:{display:"flex",justifyContent:"flex-start ",alignItems:"center",marginTop:"1.5rem",marginBottom:"1.5rem",flexDirection:p?"column":"row",gap:"1rem"},children:[e.jsx(_,{type:"submit",variant:"contained",sx:{borderRadius:"3.125rem",background:"transparent !important",border:"1px solid #FFF !important",color:"#FFFFFF",textAlign:"center",fontFamily:"Montserrat",fontSize:"1rem",fontStyle:"normal",fontWeight:400,lineHeight:"normal",textTransform:"capitalize",letterSpacing:"0.02rem",padding:"0.7rem 1.75rem",boxShadow:"unset",":hover":{background:"#FFF !important",color:"#1B5F90",boxShadow:"unset"}},children:c}),e.jsx(i,{sx:{cursor:"pointer",textUnderlineOffset:"4px",color:"#FFF",textAlign:"center",fontFamily:"Montserrat",fontSize:"0.9375rem",fontStyle:"normal",fontWeight:400,lineHeight:"normal"},onClick:()=>x(),children:a("login.loginText.forgotPasswordText")})]})]})})})}function Xe(l){const{handleSubmit:c,widgetBodyText:g,createAccountButtonText:x}=l,p=fe(),[a]=R();return e.jsxs(i,{sx:{padding:a?"16px":"20px",borderRadius:"4px",mt:a?"0":"0px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx(i,{component:"img",src:"https://cdn11.bigcommerce.com/s-optqkityfr/images/stencil/original/image-manager/logo-dermalink-sitio-2.png?t=1729085670",alt:"Dermalink Logo",sx:{width:"3.6rem",marginBottom:"1rem"}}),e.jsx(k,{sx:{minHeight:"250px","& .panel":{".panel-title":{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",fontWeight:400,fontSize:a?"1.375rem":"1.5rem",marginTop:"0px",color:"#EA617C"}},"& .panel-body":{".new-customer-fact-list":{lineHeight:"1.8rem"}}},html:g}),e.jsx(i,{sx:{marginTop:"5px"},children:e.jsx(_,{type:"submit",onClick:c,variant:"contained",sx:{ml:a?0:1,backgroundColor:p.palette.primary.main},children:x})})]})}const Ze=()=>{const l=j(({b2bFeatures:d})=>d.masqueradeCompany.isAgenting),c=j(({company:d})=>d.customer.b2bId),g=j(({b2bFeatures:d})=>d.masqueradeCompany.id),x=G(),p=l&&typeof c=="number";return{endMasquerade:y.useCallback(async()=>{p&&(await Be(+g,c),x(Se()))},[c,p,g,x]),isMasquerade:p}},et=l=>{if(l)switch(l){case"1":return"error";case"4":return"error";case"5":return"warning";default:return"success"}};function It(l){const{isMasquerade:c,endMasquerade:g}=Ze(),{setOpenPage:x}=l,p=G(),a=j(Te),d=j(({quoteInfo:r})=>r.quoteDetailToCheckoutUrl),[I,f]=y.useState(!0),[t]=R(),[A,B]=y.useState(!0),[w,F]=y.useState(""),[T,V]=y.useState({emailAddress:"",password:""}),b=be(),n=N(),[P,Q]=we(),{state:{isCheckout:Y,logo:$,registerEnabled:C}}=y.useContext(Ce),{state:{loginPageButton:K,loginPageDisplay:X,loginPageHtml:Z,portalStyle:{backgroundColor:ee="FEF9F5"}}}=y.useContext(Le),{createAccountButtonText:te,primaryButtonColor:oe,signInButtonText:ne}=K,{displayStoreLogo:ie,pageTitle:re}=X,{bottomHtmlRegionEnabled:se,bottomHtmlRegionHtml:ae,createAccountPanelHtml:le,topHtmlRegionEnabled:ce,topHtmlRegionHtml:ge}=Z,m={loginTitle:re||n("login.button.signIn"),loginBtn:ne||n("login.button.signInUppercase"),createAccountButtonText:te||n("login.button.createAccount"),btnColor:oe||"",widgetHeadText:ce?ge:void 0,widgetBodyText:le||je,widgetFooterText:se?ae:void 0,logo:ie?$:void 0};y.useEffect(()=>{(async()=>{var s;try{const h=P.get("loginFlag"),H=P.get("showTip")!=="false";if(B(H),h&&F(h),h==="7"&&U.error(n("login.loginText.invoiceErrorTip")),h==="3"&&a){const S=await Ae();if((s=S.data.site.cart)!=null&&s.entityId){const M=Pe(S.data.site.cart.entityId);await He(M)}const u=await J();u.errors&&console.log("LOGOUT INVALIDO: ".concat(u.errors[0].message));const{result:o}=(await J()).data.logout;if(o!=="success")return;c&&await g(),window.sessionStorage.clear(),ke(),f(!1),window.location.reload();return}f(!1)}finally{f(!1)}})()},[n,g,a,c,P]);const v=(r,s="")=>{if(!r)return"";switch(r){case"1":return n("login.loginTipInfo.resetPassword",{email:s});case"2":return n("login.loginTipInfo.receivePassword");case"3":return n("login.loginTipInfo.loggedOutLogin");case"4":return n("login.loginTipInfo.accountincorrect");case"5":return n("login.loginTipInfo.accountPrelaunch");case"6":return n("login.loginText.deviceCrowdingLogIn");default:return""}},D=async r=>{const s=await Oe(r);F(s?"1":"4")},de=async r=>{if(f(!0),V(r),Q(s=>(s.delete("loginFlag"),s)),Y)try{await Ge(r),window.location.reload()}catch(s){ze.error(s),D(r.emailAddress)}else try{const s={email:r.emailAddress,password:r.password,storeHash:Re,channelId:ve},{login:{result:{token:h,storefrontLoginToken:H,permissions:S},errors:u}}=await Ne({loginData:s});if(p(De(h)),Me.dispatch(qe(S)),Ee(H),u!=null&&u[0]||!h){if(u!=null&&u[0]){const{message:o}=u[0];if(o==="Operation cannot be performed as the storefront channel is not live"){F("5"),f(!1);return}}D(r.emailAddress)}else{const o=await We(h);if(d){b(d);return}if((o==null?void 0:o.userType)===O.MULTIPLE_B2C&&(o==null?void 0:o.role)===z.SUPER_ADMIN){b("/dashboard");return}if(!Je(b))return;const{getShoppingListPermission:q,getOrderPermission:E}=Ue();if((o==null?void 0:o.role)===z.JUNIOR_BUYER&&(o==null?void 0:o.companyRoleName)==="Junior Buyer")b(q?"/shoppingLists":"/accountSettings");else{let L=E?"/orders":"/shoppingLists";L=q||E?L:"/accountSettings",L=(o==null?void 0:o.userType)===O.B2C?"/orders":L,b(L)}}}catch(s){U.error(n("login.loginTipInfo.accountincorrect"))}finally{f(!1)}},me=()=>{b("/register")},ue=()=>{b("/forgotpassword")},pe=C?"100%":"50%",xe=C?"calc(50% - 1.75rem)":"auto";return e.jsx(Fe,{setOpenPage:x,children:e.jsx(Ye,{paddings:t?"0":"20px 20px",children:e.jsx(Ie,{isSpinning:I,tip:n("global.tips.loading"),background:"transparent",children:e.jsx(i,{sx:{display:"flex",flexDirection:"column",width:"100%",minHeight:"400px",minWidth:"343px"},children:m&&e.jsxs(e.Fragment,{children:[d&&e.jsx(W,{severity:"error",variant:"outlined",children:n("login.loginText.quoteDetailToCheckoutUrl")}),m.logo&&e.jsx(i,{sx:{margin:"20px 0",minHeight:"150px"},children:e.jsx($e,{children:e.jsx(he,{sx:{maxWidth:t?"70%":"250px"},onClick:()=>{window.location.href="/"},children:e.jsx("img",{src:m.logo,alt:n("login.registerLogo"),loading:"lazy"})})})}),w&&A&&e.jsx(i,{sx:{padding:t?0:"0 5%",margin:"10px 0 0 0"},children:v(w,T==null?void 0:T.emailAddress)&&e.jsx(W,{severity:et(w),variant:"outlined",children:v(w,(T==null?void 0:T.emailAddress)||"")})}),m.widgetHeadText&&e.jsx(k,{sx:{minHeight:"48px",width:C||t?"100%":"50%"},html:m.widgetHeadText}),e.jsx(i,{sx:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"},children:e.jsx(i,{sx:{bgcolor:"#FFFFFF",borderRadius:"4px",margin:"20px 0",display:"flex",flexDirection:"column",justifyContent:"center",width:t?"100%":pe},children:e.jsxs(i,{sx:{mb:"20px",display:"flex",flexDirection:t?"column":"row",justifyContent:"center",alignItems:"center",padding:"0 15px",width:t?"auto":"100%",gap:t?"1.25rem":"1.75rem"},children:[e.jsxs(i,{sx:{width:t?"100%":xe,maxWidth:t?"unset":"35rem",pb:C?"":"36px",background:"linear-gradient(92deg, #1B5F90 16.56%, #0976C4 77.16%)",borderRadius:"0.625rem",display:"flex",justifyContent:"center",alignItems:"center",minHeight:t?"16rem":"100%",flexDirection:"column",padding:t?"1.25rem":"2.5rem"},children:[e.jsx(ye,{variant:"h2",sx:{margin:"2rem 0",display:"flex",justifyContent:"center",alignItems:"center",fontFamily:"Montserrat",fontStyle:"normal",fontWeight:400,lineHeight:"normal",fontSize:t?"1.625rem":"2.5rem",textAlign:t?"center":"initial",mt:t?"1rem":"0",color:"#FFF"},children:n("login.loginText.signInHeader")}),e.jsx(Ke,{loginBtn:m.loginBtn,gotoForgotPassword:ue,handleLoginSubmit:de,backgroundColor:ee})]}),C&&e.jsx(i,{sx:{flex:"1",background:"#FFF",boxShadow:"2px 2px 10px 0px rgba(0, 0, 0, 0.25)",borderRadius:"0.625rem",display:"flex",justifyContent:"center",alignItems:"center",minHeight:t?"16rem":"28rem",padding:t?"1.25rem":"2.5rem",maxWidth:t?"unset":"35rem"},children:e.jsx(Xe,{createAccountButtonText:m.createAccountButtonText,widgetBodyText:m.widgetBodyText,handleSubmit:me})})]})})}),m.widgetFooterText&&e.jsx(k,{sx:{minHeight:"48px",width:C||t?"100%":"50%"},html:m.widgetFooterText})]})})})})})}export{It as default};
